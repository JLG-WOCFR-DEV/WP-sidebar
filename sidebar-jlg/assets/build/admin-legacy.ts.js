(()=>{var e,t,i={711:(e,t,i)=>{function n(){return"undefined"!=typeof window&&window.sidebarJLG&&"object"==typeof window.sidebarJLG?window.sidebarJLG:"undefined"!=typeof sidebarJLG&&"object"==typeof sidebarJLG?sidebarJLG:null}function s(e,t=""){const i=n();return i&&i.i18n&&"string"==typeof i.i18n[e]?i.i18n[e]:t}function r(e){if(e&&"object"==typeof e)return e;const t=n();return t&&"object"==typeof t.svg_url_restrictions&&null!==t.svg_url_restrictions?t.svg_url_restrictions:{}}function a(e){if("string"!=typeof e)return"";let t=e.replace(/\\/g,"/").trim();return""===t?"":(t=t.replace(/\/{2,}/g,"/"),t=t.replace(/^\/+/g,""),"/"+t)}function o(e){if(!e||"object"!=typeof e)return"";const t="string"==typeof e.allowed_path?e.allowed_path:"",i="string"==typeof e.host?e.host:"";return i?i+(t||""):t||""}function l(...e){return e.filter(Boolean).join(" ")}function c(e){if(null===e||"object"!=typeof e)return e;try{return JSON.parse(JSON.stringify(e))}catch(t){if(Array.isArray(e))return e.map(e=>c(e));const i={};return Object.keys(e).forEach(t=>{i[t]=c(e[t])}),i}}function d(e){return"string"!=typeof e?"":e.replace(/[^a-z0-9_-]/gi,"").toLowerCase()}function u(e){const t=d(e)||"widget",i=Math.floor(99999*Math.random()).toString(36);return`${t}-${Date.now().toString(36)}-${i}`}function p(e){const t={};return e&&"object"==typeof e?(Object.keys(e).forEach(i=>{const n=e[i];if(!n||"object"!=typeof n)return;const s="string"==typeof n.type?n.type:"text",r=n.default;switch(s){case"boolean":t[i]=!!r;break;case"number":t[i]=Number.isFinite(Number(r))?Number(r):0;break;case"dimension":{const e=Array.isArray(n.units)&&n.units.length?n.units[0]:"px",s=r&&"object"==typeof r?r:{},a="string"==typeof s.value||"number"==typeof s.value?String(s.value):"",o="string"==typeof s.unit&&""!==s.unit?s.unit:e;t[i]={value:a,unit:o};break}case"repeater":t[i]=Array.isArray(r)?c(r):[];break;default:t[i]="string"==typeof r?r:""}}),t):t}function h(e,t){const i=d(e)||"widget",n=t&&"string"==typeof t.label?t.label:i,s=p(t&&t.content?t.content:{}),r=p(t&&t.style?t.style:{}),a=p(t&&t.tracking&&t.tracking.fields?t.tracking.fields:{}),o={};return t&&t.tracking&&t.tracking.events&&"object"==typeof t.tracking.events&&Object.keys(t.tracking.events).forEach(e=>{const i=t.tracking.events[e];if("string"==typeof i&&""!==i.trim()){const t=i.trim().replace(/[^a-z0-9_]+/gi,"_").toLowerCase();""!==t&&(o[e]=t)}}),{id:u(i),type:i,title:n,is_enabled:!0,content:s,style:r,tracking:{events:o,...a}}}function m(e,t,i){const n=c(e||{});return t&&"object"==typeof t?(Object.keys(t).forEach(e=>{const s=t[e],r=i&&i[e]?i[e]:null;switch(r&&"string"==typeof r.type?r.type:"text"){case"boolean":n[e]=!!s;break;case"number":Number.isFinite(Number(s))&&(n[e]=Number(s));break;case"dimension":if(s&&"object"==typeof s){const t=n[e]||{},i=Array.isArray(r&&r.units)&&r.units.length?r.units:["px"],a="string"==typeof t.unit&&""!==t.unit?t.unit:i[0],o=void 0!==s.value?s.value:t.value,l=void 0!==s.unit?s.unit:a;n[e]={value:"string"==typeof o?o:String(o||""),unit:"string"==typeof l&&""!==l?l:a}}break;case"repeater":Array.isArray(s)&&(n[e]=c(s));break;default:"string"==typeof s&&(n[e]=s)}}),n):n}function g(e){return String(null==e?"":e).replace(/[&<>"']/g,e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";default:return e}})}function b({container:e,hiddenField:t,schemas:i}){if(!e||"object"!=typeof e)return null;const n=e.getAttribute("data-widget-schemas"),r=e.getAttribute("data-widget-options");let a={},o=[];if(i&&"object"==typeof i&&(a={...i}),n)try{const e=JSON.parse(n);e&&"object"==typeof e&&(a={...e})}catch(e){}if(r)try{const e=JSON.parse(r);Array.isArray(e)&&(o=e)}catch(e){o=[]}const l={};Object.keys(a).forEach(e=>{const t=d(e);if(""===t)return;const i=a[e];i&&"object"==typeof i&&(l[t]=i)});const c=e.querySelector("[data-widget-list]"),u=e.querySelector("[data-widget-editor]"),p=u?u.querySelector("[data-widget-editor-empty]"):null,b=e.querySelector("[data-widget-preview-frame]"),f=e.querySelector("[data-widget-type]"),y=e.querySelector("[data-widget-add]");let v=function(e,t){if(!Array.isArray(e))return[];const i=[];return e.forEach(e=>{if(!e||"object"!=typeof e)return;const n=d(e.type);if(""===n||!t[n])return;const s=t[n],r=h(n,s),a={...r,id:"string"==typeof e.id&&""!==e.id?e.id:r.id,title:"string"==typeof e.title&&""!==e.title?e.title:r.title,is_enabled:void 0!==e.is_enabled?!!e.is_enabled:r.is_enabled};a.content=m(r.content,e.content,s&&s.content?s.content:{}),a.style=m(r.style,e.style,s&&s.style?s.style:{});const o=s&&s.tracking&&s.tracking.fields?s.tracking.fields:{},l={events:{...r.tracking.events}};Object.keys(r.tracking).forEach(e=>{"events"!==e&&(l[e]=r.tracking[e])});const c=m(l,e.tracking,o);e.tracking&&"object"==typeof e.tracking&&e.tracking.events&&"object"==typeof e.tracking.events&&Object.keys(e.tracking.events).forEach(t=>{const i=e.tracking.events[t];if("string"==typeof i&&""!==i.trim()){const e=i.trim().replace(/[^a-z0-9_]+/gi,"_").toLowerCase();""!==e&&(c.events[t]=e)}}),a.tracking=c,i.push(a)}),i}(o,l),_=v.length>0?v[0].id:"";function w(){t&&(t.value=function(e){try{return JSON.stringify(Array.isArray(e)?e:[])}catch(e){return"[]"}}(v))}function S(){_&&v.some(e=>e.id===_)||(_=v.length>0?v[0].id:"")}function x(){if(!c)return;S();const e=c.scrollTop,t=_;c.innerHTML="",v.forEach((e,i)=>{const n=l[e.type]||{},r=document.createElement("div");r.className="sidebar-jlg-widget-card",r.dataset.index=String(i),r.dataset.widgetId=e.id,r.setAttribute("role","listitem"),e.id===_&&r.classList.add("is-active");const a=document.createElement("div");a.className="sidebar-jlg-widget-card__header";const o=document.createElement("span");o.className="sidebar-jlg-widget-card__handle",o.setAttribute("aria-hidden","true"),o.textContent="⋮⋮";const d=document.createElement("button");d.type="button",d.className="sidebar-jlg-widget-card__select";const u=e.title&&""!==e.title.trim()?e.title:n.label||e.type;d.textContent=u,d.addEventListener("click",()=>{_=e.id,C()});const p=document.createElement("label");p.className="sidebar-jlg-widget-card__toggle";const h=document.createElement("input");h.type="checkbox",h.checked=!!e.is_enabled,h.setAttribute("aria-label",s("widgetsToggleLabel","Activer le widget")),h.addEventListener("change",()=>{e.is_enabled=h.checked,w(),k()}),p.appendChild(h);const m=document.createElement("span");m.className="sidebar-jlg-widget-card__toggle-text",m.textContent=s("widgetsToggleText","Actif"),p.appendChild(m);const g=document.createElement("button");g.type="button",g.className="button-link sidebar-jlg-widget-card__delete",g.textContent=s("widgetsDelete","Supprimer"),g.addEventListener("click",()=>{const i=s("widgetsDeleteConfirm","Supprimer ce widget ?");window.confirm(i)&&(v=v.filter(t=>t.id!==e.id),_===e.id&&(_=t),w(),C())}),a.appendChild(o),a.appendChild(d),a.appendChild(p),a.appendChild(g),r.appendChild(a),c.appendChild(r)}),c.scrollTop=e,function(){if(!c||!window.jQuery)return;const e=window.jQuery(c);"function"==typeof e.sortable&&(e.data("ui-sortable")&&e.sortable("destroy"),e.sortable({handle:".sidebar-jlg-widget-card__handle",placeholder:"sidebar-jlg-widget-card__placeholder",update:()=>{const t=[];if(e.children().each(function(){const e=this.getAttribute("data-widget-id");e&&t.push(e)}),t.length!==v.length)return;const i=[];t.forEach(e=>{const t=v.find(t=>t.id===e);t&&i.push(t)}),i.length===v.length&&(v=i,w(),C())}}))}()}function k(){if(!b)return;S();const e=v.find(e=>e.id===_);if(!e)return void(b.innerHTML='<p class="description">'+g(s("widgetsPreviewEmpty","Ajoutez un widget pour afficher un aperçu."))+"</p>");const t=function(e,t){const i=g(e.content&&e.content.title?e.content.title:e.title||t.label||e.type),n=e.style&&e.style.accent_color?e.style.accent_color:"#2563eb",r=e.style&&e.style.background_color?e.style.background_color:"rgba(15,23,42,0.92)",a=e.style&&e.style.text_color?e.style.text_color:"#f8fafc";switch(e.type){case"cta":{const t=e.content&&e.content.message?e.content.message:"";return`\n                    <div class="sidebar-jlg-widget-preview sidebar-jlg-widget-preview--cta" style="background:${r};color:${a}">\n                        <h4>${i}</h4>\n                        ${t?`<div class="sidebar-jlg-widget-preview__content">${t}</div>`:""}\n                        <div class="sidebar-jlg-widget-preview__actions">\n                            <span class="sidebar-jlg-widget-preview__button" style="background:${n}">${g(e.content&&e.content.button_label?e.content.button_label:s("widgetsCtaButton","En savoir plus"))}</span>\n                        </div>\n                    </div>\n                `}case"form":{const t=e.content&&e.content.intro?e.content.intro:"",o=e.content&&e.content.shortcode?e.content.shortcode:"";return`\n                    <div class="sidebar-jlg-widget-preview sidebar-jlg-widget-preview--form" style="background:${r};color:${a}">\n                        <h4>${i}</h4>\n                        ${t?`<p>${g(t)}</p>`:""}\n                        <div class="sidebar-jlg-widget-preview__form">\n                            <label><span>${g(s("widgetsFormLabel","Email"))}</span><input type="email" placeholder="${g(s("widgetsFormPlaceholder","vous@example.com"))}" /></label>\n                            <button type="button" class="button" style="background:${n}">${g(s("widgetsFormSubmit","Envoyer"))}</button>\n                        </div>\n                        ${o?`<code class="sidebar-jlg-widget-preview__shortcode">${g(o)}</code>`:""}\n                    </div>\n                `}case"slider":return`\n                    <div class="sidebar-jlg-widget-preview sidebar-jlg-widget-preview--slider" style="background:${r};color:${a}">\n                        <h4>${i}</h4>\n                        <ul>${(Array.isArray(e.content&&e.content.items?e.content.items:[])?e.content.items.slice(0,3):[]).map(e=>{const t=g(e&&e.heading?e.heading:s("widgetsSliderHeading","Slide")),i=g(e&&e.text?e.text:"");return`<li><strong>${t}</strong>${i?`<p>${i}</p>`:""}</li>`}).join("")}</ul>\n                        <p class="sidebar-jlg-widget-preview__hint">${g(s("widgetsSliderHint","Lecture automatique activée"))}</p>\n                    </div>\n                `;case"woocommerce":{const t=e.content&&e.content.mode?e.content.mode:"product",n=e.content&&e.content.ids?e.content.ids:"";return`\n                    <div class="sidebar-jlg-widget-preview sidebar-jlg-widget-preview--woocommerce" style="background:${r};color:${a}">\n                        <h4>${i}</h4>\n                        <p>${g(s("widgetsWooMode","Mode"))}: <strong>${g(t)}</strong></p>\n                        ${n?`<p>${g(s("widgetsWooIds","Cibles"))}: ${g(n)}</p>`:""}\n                        <div class="sidebar-jlg-widget-preview__products">\n                            <span class="sidebar-jlg-widget-preview__pill">${g(s("widgetsWooSample","Produit en avant"))}</span>\n                            <span class="sidebar-jlg-widget-preview__pill">${g(s("widgetsWooSample","Produit en avant"))}</span>\n                        </div>\n                    </div>\n                `}default:return`<div class="sidebar-jlg-widget-preview"><h4>${i}</h4></div>`}}(e,l[e.type]||{});b.innerHTML=t}function j(e,t,i){const n=v.findIndex(t=>t.id===e);if(-1===n)return;let s=v[n];for(let e=0;e<t.length-1;e+=1){const i=t[e];s[i]&&"object"==typeof s[i]||(s[i]={}),s=s[i]}s[t[t.length-1]]=i,w(),x(),k()}function C(){x(),function(){if(!u)return;S();const e=v.find(e=>e.id===_);if(u.innerHTML="",!e)return void(p&&(p.style.display=""));p&&(p.style.display="none");const t=l[e.type]||{};[{key:"content",schema:t.content||{},label:s("widgetsSectionContent","Contenu")},{key:"style",schema:t.style||{},label:s("widgetsSectionStyle","Style")},{key:"tracking",schema:t.tracking&&t.tracking.fields?t.tracking.fields:{},label:s("widgetsSectionTracking","Tracking")}].forEach(t=>{if(!t.schema||0===Object.keys(t.schema).length)return;const i=document.createElement("fieldset");i.className="sidebar-jlg-widgets-fieldset";const n=document.createElement("legend");n.textContent=t.label,i.appendChild(n),Object.keys(t.schema).forEach(n=>{const r=function(e,t,i,n,r){if(!n||"object"!=typeof n)return null;const a=function(e,t){const i=document.createElement("div");if(i.className="sidebar-jlg-widget-field",e){const t=document.createElement("label");t.textContent=e,i.appendChild(t)}if(t){const e=document.createElement("p");e.className="description",e.textContent=t,i.appendChild(e)}return i}(n.label||i,n.description||""),o=n.type||"text",l=[t,i];switch(o){case"textarea":case"richtext":{const t=document.createElement("textarea");t.value="string"==typeof r?r:"",t.addEventListener("input",()=>{j(e.id,l,t.value)}),a.appendChild(t);break}case"url":case"text":{const t=document.createElement("input");t.type="url"===o?"url":"text",t.value="string"==typeof r?r:"",n.placeholder&&(t.placeholder=n.placeholder),t.addEventListener("input",()=>{j(e.id,l,t.value)}),a.appendChild(t);break}case"select":{const t=document.createElement("select"),i=Array.isArray(n.choices)?n.choices:[];i.forEach(e=>{const i=document.createElement("option");i.value=e,i.textContent=e,t.appendChild(i)}),t.value="string"==typeof r&&""!==r?r:i[0]||"",t.addEventListener("change",()=>{j(e.id,l,t.value)}),a.appendChild(t);break}case"boolean":{const t=document.createElement("input");t.type="checkbox",t.checked=!!r,t.addEventListener("change",()=>{j(e.id,l,t.checked)}),a.appendChild(t);break}case"number":{const t=document.createElement("input");t.type="number",t.value=Number.isFinite(Number(r))?Number(r):n.default||0,t.addEventListener("input",()=>{const i=Number(t.value);j(e.id,l,Number.isFinite(i)?i:0)}),a.appendChild(t);break}case"dimension":{const t=r&&"object"==typeof r?r:{value:"",unit:""},i=Array.isArray(n.units)&&n.units.length?n.units:["px"],s=document.createElement("input");s.type="text",s.value="string"==typeof t.value?t.value:String(t.value||""),s.style.marginRight="8px";const o=document.createElement("select");i.forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e,o.appendChild(t)}),o.value="string"==typeof t.unit&&""!==t.unit?t.unit:i[0];const c=()=>{j(e.id,l,{value:s.value,unit:o.value})};s.addEventListener("input",c),o.addEventListener("change",c),a.appendChild(s),a.appendChild(o);break}case"repeater":{const t=Array.isArray(r)?r:[],i=document.createElement("div");i.className="sidebar-jlg-widget-field__repeater";const n=e=>e&&"object"==typeof e?{heading:"string"==typeof e.heading?e.heading:"",text:"string"==typeof e.text?e.text:"",media:"string"==typeof e.media?e.media:"",media_alt:"string"==typeof e.media_alt?e.media_alt:"",caption:"string"==typeof e.caption?e.caption:""}:{heading:"",text:"",media:"",media_alt:"",caption:""},o="undefined"!=typeof window&&window.wp&&window.wp.media&&"function"==typeof window.wp.media,c=()=>{i.innerHTML="",t.forEach((r,a)=>{const d=n(r);t[a]=d;const u=document.createElement("div");u.className="sidebar-jlg-widget-field__repeater-item";const p=document.createElement("input");p.type="text",p.placeholder=s("widgetsRepeaterHeading","Titre"),p.value=d.heading,p.addEventListener("input",()=>{d.heading=p.value,j(e.id,l,t)});const h=document.createElement("textarea");h.placeholder=s("widgetsRepeaterContent","Contenu"),h.value=d.text,h.addEventListener("input",()=>{d.text=h.value,j(e.id,l,t)});const m=document.createElement("div");m.className="sidebar-jlg-widget-field__repeater-media";const g=document.createElement("input");g.type="url",g.placeholder=s("widgetsRepeaterMedia","Image (URL)"),g.value=d.media,g.addEventListener("input",()=>{d.media=g.value.trim(),j(e.id,l,t)}),m.appendChild(g);const b=document.createElement("input");if(b.type="text",b.placeholder=s("widgetsRepeaterMediaAlt","Texte alternatif"),b.value=d.media_alt,b.addEventListener("input",()=>{d.media_alt=b.value,j(e.id,l,t)}),o){const i=document.createElement("div");i.className="sidebar-jlg-widget-field__repeater-media-actions";const n=document.createElement("button");n.type="button",n.className="button button-secondary",n.textContent=s("widgetsRepeaterMediaChoose","Choisir une image"),n.addEventListener("click",i=>{i.preventDefault();const n=window.wp.media({title:s("widgetsRepeaterMediaChoose","Choisir une image"),button:{text:s("widgetsRepeaterMediaUse","Utiliser cette image")},multiple:!1,library:{type:["image"]}});n.on("select",()=>{const i=n.state().get("selection"),s=i&&i.first?i.first():null;if(!s||"function"!=typeof s.toJSON)return;const r=s.toJSON(),a=r&&"string"==typeof r.url?r.url:"";a&&(g.value=a,d.media=a);const o=r&&"string"==typeof r.alt?r.alt:"";o&&!d.media_alt&&(b.value=o,d.media_alt=o),j(e.id,l,t)}),n.open()});const r=document.createElement("button");r.type="button",r.className="button-link",r.textContent=s("widgetsRepeaterMediaRemove","Retirer l’image"),r.addEventListener("click",i=>{i.preventDefault(),g.value="",b.value="",d.media="",d.media_alt="",j(e.id,l,t)}),i.appendChild(n),i.appendChild(r),m.appendChild(i)}m.appendChild(b);const f=document.createElement("input");f.type="text",f.placeholder=s("widgetsRepeaterCaption","Légende"),f.value=d.caption,f.addEventListener("input",()=>{d.caption=f.value,j(e.id,l,t)});const y=document.createElement("button");y.type="button",y.className="button-link",y.textContent=s("widgetsRepeaterRemove","Supprimer"),y.addEventListener("click",()=>{t.splice(a,1),j(e.id,l,t),c()}),u.appendChild(p),u.appendChild(h),u.appendChild(m),u.appendChild(f),u.appendChild(y),i.appendChild(u)})};c();const d=document.createElement("button");d.type="button",d.className="button",d.textContent=s("widgetsRepeaterAdd","Ajouter un élément"),d.addEventListener("click",()=>{t.push({heading:"",text:"",media:"",media_alt:"",caption:""}),j(e.id,l,t),c()}),a.appendChild(i),a.appendChild(d);break}}return a}(e,t.key,n,t.schema[n],e[t.key]?e[t.key][n]:void 0);r&&i.appendChild(r)}),u.appendChild(i)})}(),k(),w()}return y&&y.addEventListener("click",()=>{if(!f)return;const e=d(f.value);if(!e||!l[e])return void f.focus();const t=h(e,l[e]);v.push(t),_=t.id,C(),f.options.length>0&&(f.selectedIndex=0)}),C(),{getWidgets:()=>v.slice(),setSelectedId:e=>{_=e,C()},refresh:C}}function f(e){if("number"==typeof e)return Number.isFinite(e)?Math.abs(e-Math.round(e))<1e-4?String(Math.round(e)):String(parseFloat(e.toFixed(4))):"";if("string"!=typeof e)return"";const t=e.trim();if(""===t)return"";const i=Number(t);return Number.isFinite(i)?Math.abs(i-Math.round(i))<1e-4?String(Math.round(i)):String(parseFloat(i.toFixed(4))):""}function y(e,t="px",i=null){const n="string"==typeof t&&""!==t.trim()?t.trim():"px",s=Array.isArray(i)&&i.length?i.map(e=>"string"==typeof e?e.trim():"").filter(Boolean):null,r=e=>{const t="string"==typeof e?e.trim():"";return s&&s.length?s.includes(t)?t:s[0]:t||n},a=(e,t)=>({value:f(e),unit:r(t)});if(e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"value"))return a(e.value,e.unit);if("number"==typeof e)return a(e,n);if("string"==typeof e){const t=e.trim();if(""===t)return{value:"",unit:n};const i=t.match(/^(-?(?:\d+|\d*\.\d+))\s*([a-z%]*)$/i);if(i)return a(i[1],i[2]||n)}return{value:"",unit:s&&s.length?s[0]:n}}function v(e){e&&(e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})))}function _(e,t,i){if(!t||"function"!=typeof t.empty||"function"!=typeof t.append)return!1;const n=r(i),c=function(e){const t=o(e);return t?s("svgUrlOutOfScopeWithDescription","Cette URL ne sera pas enregistrée. Utilisez une adresse dans %s.").replace("%s",t):s("svgUrlOutOfScope","Cette URL ne sera pas enregistrée car elle est en dehors de la zone autorisée.")}(n),d="function"==typeof t.siblings?t.siblings(".icon-preview-status"):null,u="function"==typeof t.siblings?t.siblings(".icon-input"):null,p=(e,t)=>{if(!d||!d.length)return;const i=e||"";d.text(i),t?d.addClass("is-error"):d.removeClass("is-error")},h=e=>{u&&u.length&&(e?(u.removeClass("icon-input-invalid"),u.removeAttr("aria-invalid")):(u.addClass("icon-input-invalid"),u.attr("aria-invalid","true")))},m=()=>{t.empty()};if(!e)return m(),p("",!1),h(!0),!1;let g;try{g=new URL(e,window.location.origin)}catch(e){return m(),p(l(s("invalidUrl","URL invalide."),c),!0),h(!1),!1}if("https:"!==g.protocol&&"http:"!==g.protocol)return m(),p(l(s("httpOnly","Seuls les liens HTTP(S) sont autorisés."),c),!0),h(!1),!1;if(!function(e,t,i){const n=function(e){const t=a(e);return t?t.endsWith("/")?t:t+"/":""}(i.allowed_path);if(!n)return!1;const s=a(e.pathname||"")||"";if(!s)return!1;if(0!==s.indexOf(n))return!1;const r=/^https?:\/\//i.test(t)||t.startsWith("//"),o="string"==typeof i.host&&""!==i.host?i.host.toLowerCase():null;return!r||!(!e.hostname||!o)&&e.hostname.toLowerCase()===o}(g,e,n))return m(),p(c,!0),h(!1),!1;const b=document.createElement("img");return b.src=g.href,b.alt=s("iconPreviewAlt","preview"),m(),p("",!1),h(!0),t.append(b),!0}e.exports&&(e.exports.renderSvgUrlPreview=_);let w=null,S=null;function x(e){return Array.isArray(e)?e.reduce((e,t)=>{if(!t)return e;let i="";if("number"==typeof t.id||"string"==typeof t.id?i=String(t.id):"number"!=typeof t.term_id&&"string"!=typeof t.term_id||(i=String(t.term_id)),""===i)return e;const n="string"==typeof t.name&&""!==t.name.trim()?t.name:"string"==typeof t.slug&&""!==t.slug?t.slug:i;return e.push({id:i,name:n,slug:"string"==typeof t.slug?t.slug:""}),e},[]):[]}function k(){return window.wp&&wp.apiFetch&&"function"==typeof wp.apiFetch?wp.apiFetch({path:"/wp/v2/menus?per_page=100"}).then(e=>x(e)).catch(()=>[]):Promise.resolve([])}class j{constructor(e={}){this.container=e.container||null,this.viewportsContainer=this.container?this.container.querySelector("[data-sidebar-preview-viewports]"):null,this.viewport=this.viewportsContainer?this.viewportsContainer.querySelector('[data-preview-role="primary"]'):this.container?this.container.querySelector(".sidebar-jlg-preview__viewport"):null,this.splitViewClones=this.viewportsContainer?Array.from(this.viewportsContainer.querySelectorAll('[data-preview-role="split"]')):[],this.statusElement=this.container?this.container.querySelector(".sidebar-jlg-preview__status"):null,this.form=e.form||null,this.ajaxUrl=e.ajaxUrl||"",this.nonce=e.nonce||"",this.action=e.action||"jlg_render_preview",this.messages=Object.assign({loading:"",error:"",emptyMenu:"",refresh:""},e.messages||{}),this.initialOptions=j.cloneObject(e.options||{}),this.currentOptions=j.cloneObject(this.initialOptions),this.fontStacks=j.cloneObject(e.fontStacks||{}),this.defaultFontStack="string"==typeof e.defaultFontStack&&""!==e.defaultFontStack?e.defaultFontStack:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',this.dimensionKeys=["content_margin","floating_vertical_margin","border_radius","hamburger_top_position","hamburger_horizontal_offset","hamburger_size","header_padding_top","horizontal_bar_height","letter_spacing"],this.dimensionKeys.forEach(e=>{const t=y(this.initialOptions[e],"px");this.initialOptions[e]=t,this.currentOptions[e]=y(this.currentOptions[e],t.unit)}),this.$="undefined"!=typeof window?window.jQuery:null;const t=this.container?this.container.getAttribute("data-preview-size"):"";this.previewSize=j.normalizePreviewSize(t),this.toolbar=this.container?this.container.querySelector(".sidebar-jlg-preview__toolbar"):null,this.previewButtons=this.toolbar?Array.from(this.toolbar.querySelectorAll("[data-preview-size]")):[],this.toolbarInitialized=!1,this.splitToggle=this.toolbar?this.toolbar.querySelector("[data-preview-split-toggle]"):null,this.touchOverlay=this.container?this.container.querySelector("[data-touch-overlay]"):null,this.breakpointsForm=this.container?this.container.querySelector("[data-preview-breakpoints]"):null,this.breakpointInputs=this.breakpointsForm?Array.from(this.breakpointsForm.querySelectorAll("[data-breakpoint-input]")):[],this.breakpointsInitialized=!1,this.splitViewEnabled=!1,this.breakpoints=j.getDefaultBreakpoints(this.container),this.applyBreakpointVariables(),this.populateBreakpointInputs(),this.aside=null,this.nav=null,this.menuList=null,this.menuSocialItem=null,this.footerSocial=null,this.hamburger=null,this.overlay=null,this.defaultNavAriaLabel="",this.defaultToggleExpandLabel="",this.defaultToggleCollapseLabel="",this.menuContainer=null,this.socialContainer=null,this.menuObserver=null,this.socialObserver=null,this.isInitializing=!1,this.updatePreviewSizeClasses(),this.updateTouchOverlay(),this.updateMenuFromDomBound=this.updateMenuFromDom.bind(this),this.updateSocialFromDomBound=this.updateSocialFromDom.bind(this),this.handleResizeBound=this.updateTouchOverlay.bind(this),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("resize",this.handleResizeBound,{passive:!0})}static normalizePreviewSize(e){const t="string"==typeof e?e.toLowerCase():"";return"mobile"===t||"tablet"===t||"desktop"===t?t:"mobile"}static getPreviewLabel(e){const t=j.normalizePreviewSize(e);return t.charAt(0).toUpperCase()+t.slice(1)}static getDefaultBreakpoints(e){const t={mobile:360,tablet:820,desktop:1160};return e?{mobile:j.parseBreakpoint(e.getAttribute("data-breakpoint-mobile"),t.mobile),tablet:j.parseBreakpoint(e.getAttribute("data-breakpoint-tablet"),t.tablet),desktop:j.parseBreakpoint(e.getAttribute("data-breakpoint-desktop"),t.desktop)}:t}static normalizeBreakpointKey(e){const t="string"==typeof e?e.toLowerCase():"";return"mobile"===t||"tablet"===t||"desktop"===t?t:""}static parseBreakpoint(e,t){const i=Number.isFinite(t)?t:0;if("number"==typeof e&&Number.isFinite(e))return Math.max(0,Math.round(e));if("string"!=typeof e)return i;const n=e.trim();if(""===n)return i;const s=Number.parseInt(n,10);return Number.isFinite(s)?Math.max(0,s):i}static getPreviewOrder(e){const t=j.normalizePreviewSize(e);return"mobile"===t?1:"tablet"===t?2:3}static cloneObject(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return Object.assign({},e)}}captureFontStacksFromDom(){if(!this.form)return;const e=this.form.querySelector('select[name="sidebar_jlg_settings[font_family]"]');if(!e)return;const t=Array.from(e.options||[]);t.length&&t.forEach(e=>{if(!e||"string"!=typeof e.value)return;const t=e.value,i=e.getAttribute("data-font-stack")||"";""!==t&&(this.fontStacks[t]=i),!this.defaultFontStack&&i&&(this.defaultFontStack=i)})}lookupFontStack(e){if("string"!=typeof e||""===e.trim())return this.defaultFontStack;if(Object.prototype.hasOwnProperty.call(this.fontStacks,e)){const t=this.fontStacks[e];if("string"==typeof t&&""!==t.trim())return t}return this.defaultFontStack}resolveFontFamily(){if(this.currentOptions&&"string"==typeof this.currentOptions.font_stack&&""!==this.currentOptions.font_stack)return this.currentOptions.font_stack;const e=this.currentOptions?this.currentOptions.font_family:"";return this.lookupFontStack(e)}captureDefaultFontStackFromMarkup(){if(this.defaultFontStack&&""!==this.defaultFontStack)return;if("undefined"==typeof window||!window.getComputedStyle)return;if(!this.aside)return;const e=window.getComputedStyle(this.aside);if(!e)return;const t=e.getPropertyValue("font-family");"string"==typeof t&&""!==t.trim()&&(this.defaultFontStack=t.trim())}resolveAccentBaseColor(){return"gradient"===(this.currentOptions.accent_color_type||"solid").toLowerCase()?this.currentOptions.accent_color_start||this.currentOptions.accent_color||"":this.currentOptions.accent_color||""}applyAccentGradient(){if(!this.container)return;const e=(this.currentOptions.accent_color_type||"solid").toLowerCase(),t=this.currentOptions.accent_color_start||"",i=this.currentOptions.accent_color_end||"";"gradient"===e&&t&&i?this.container.style.setProperty("--sidebar-accent-gradient",`linear-gradient(135deg, ${t} 0%, ${i} 100%)`):this.container.style.setProperty("--sidebar-accent-gradient","none")}init(){this.container&&this.viewport&&this.form&&this.$&&(this.setState("loading"),this.setStatus(this.messages.loading||"",!1),this.loadPreview().then(()=>{this.setState("ready"),this.clearStatus(),this.setupToolbar(),this.setupBreakpointControls(),this.setupBindings(),this.applyOptions(),this.updateTouchOverlay()}).catch(()=>{}))}setState(e){this.container&&this.container.setAttribute("data-state",e)}setStatus(e,t){this.statusElement&&(this.statusElement.textContent=e||"",t?this.statusElement.classList.add("is-error"):this.statusElement.classList.remove("is-error"))}clearStatus(){this.setStatus("",!1)}renderFallback(e){if(!this.viewport)return;this.viewport.innerHTML="",this.setState("error"),this.setStatus(e||this.messages.error||"",!0);const t=document.createElement("div");t.className="sidebar-jlg-preview__fallback";const i=document.createElement("p");if(i.textContent=e||this.messages.error||"",t.appendChild(i),this.messages.refresh){const e=document.createElement("button");e.type="button",e.className="button",e.textContent=this.messages.refresh,e.addEventListener("click",()=>{this.setState("loading"),this.setStatus(this.messages.loading||"",!1),this.loadPreview().then(()=>{this.setState("ready"),this.clearStatus(),this.setupBindings(),this.applyOptions()}).catch(()=>{})}),t.appendChild(e)}this.viewport.appendChild(t)}loadPreview(){return this.ajaxUrl&&this.nonce&&this.action?new Promise((e,t)=>{this.$.ajax({url:this.ajaxUrl,method:"POST",dataType:"json",data:{action:this.action,nonce:this.nonce,options:JSON.stringify(this.currentOptions||{})}}).done(i=>{if(i&&i.success&&i.data&&"string"==typeof i.data.html)return this.viewport.innerHTML=i.data.html,this.afterMarkupRendered(),this.refreshSplitView(),void e(i.data);const n=i&&i.data&&i.data.message?i.data.message:this.messages.error;this.renderFallback(n||this.messages.error||""),t(new Error("Invalid preview response."))}).fail(()=>{this.renderFallback(this.messages.error||""),t(new Error("Preview request failed."))})}):(this.renderFallback(this.messages.error||""),Promise.reject(new Error("Missing preview configuration.")))}afterMarkupRendered(){this.aside=this.viewport?this.viewport.querySelector(".pro-sidebar"):null,this.nav=this.viewport?this.viewport.querySelector(".sidebar-navigation"):null,this.menuList=this.viewport?this.viewport.querySelector(".sidebar-menu"):null,this.menuSocialItem=this.viewport?this.viewport.querySelector(".social-icons-wrapper"):null,this.footerSocial=this.viewport?this.viewport.querySelector(".sidebar-footer"):null,this.hamburger=this.viewport?this.viewport.querySelector("#hamburger-btn"):null,this.overlay=this.viewport?this.viewport.querySelector(".sidebar-overlay"):null,this.nav&&(this.defaultNavAriaLabel=this.nav.getAttribute("data-default-aria-label")||this.nav.getAttribute("aria-label")||"",this.defaultToggleExpandLabel=this.nav.getAttribute("data-default-toggle-expand")||"",this.defaultToggleCollapseLabel=this.nav.getAttribute("data-default-toggle-collapse")||""),this.syncOverlayVisibility(),this.hamburger&&(this.hamburger.setAttribute("aria-hidden","true"),this.hamburger.setAttribute("tabindex","-1")),this.menuList&&this.menuSocialItem&&!this.menuList.contains(this.menuSocialItem)&&this.menuList.appendChild(this.menuSocialItem),this.captureDefaultFontStackFromMarkup(),this.updatePreviewSizeClasses(),this.updateAccessibilityLabels(),this.updateTouchOverlay()}setupToolbar(){this.container&&(this.toolbar&&this.previewButtons.length?(this.toolbarInitialized||(this.previewButtons.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const i=j.normalizePreviewSize(e.getAttribute("data-preview-size"));this.setPreviewSize(i,{triggerButton:e})})}),this.splitToggle&&this.splitToggle.addEventListener("click",e=>{e.preventDefault(),this.setSplitView(!this.splitViewEnabled)}),this.toolbarInitialized=!0),this.setPreviewSize(this.previewSize,{skipApply:!0}),this.updateSplitToggleState()):this.updatePreviewSizeClasses())}setPreviewSize(e,t={}){const i=j.normalizePreviewSize(e),{triggerButton:n=null,skipApply:s=!1}=t||{};this.previewSize=i,this.updatePreviewSizeClasses(),this.previewButtons&&this.previewButtons.length&&this.previewButtons.forEach(e=>{const t=j.normalizePreviewSize(e.getAttribute("data-preview-size")),s=n?e===n:t===i;e.classList.toggle("is-active",s),e.setAttribute("aria-pressed",s?"true":"false")}),this.isInitializing||s||this.applyOptions(),this.refreshSplitView(),this.updateTouchOverlay()}updatePreviewSizeClasses(){if(this.container&&this.container.setAttribute("data-preview-size",this.previewSize),this.viewport){this.viewport.setAttribute("data-preview-size",this.previewSize);const e=this.getPreviewButtonLabel(this.previewSize)||j.getPreviewLabel(this.previewSize);this.viewport.setAttribute("data-preview-label",e),this.replaceClass(this.viewport,"preview-",this.previewSize)}this.aside&&(this.aside.dataset.previewSize=this.previewSize,this.replaceClass(this.aside,"preview-",this.previewSize)),this.syncOverlayVisibility()}getPreviewButtonLabel(e){if(!this.previewButtons||!this.previewButtons.length)return"";const t=this.previewButtons.find(t=>j.normalizePreviewSize(t.getAttribute("data-preview-size"))===e);if(!t)return"";const i=t.querySelector('[aria-hidden="true"]');return i&&i.textContent?i.textContent.trim():t.textContent?t.textContent.trim():""}syncOverlayVisibility(){this.overlay&&("mobile"===this.previewSize?this.overlay.style.display="":this.overlay.style.display="none")}updateTouchOverlay(){if(this.touchOverlay)if("mobile"===this.previewSize||this.splitViewEnabled){this.touchOverlay.removeAttribute("hidden");const e=this.resolveMobilePreviewTarget();e&&("undefined"!=typeof window&&"function"==typeof window.requestAnimationFrame?window.requestAnimationFrame.bind(window):e=>e())(()=>{this.positionTouchOverlay(e)})}else this.touchOverlay.setAttribute("hidden","")}resolveMobilePreviewTarget(){if(!this.viewportsContainer)return"mobile"===this.previewSize?this.viewport:null;if(!this.splitViewEnabled)return"mobile"===this.previewSize?this.viewport:null;return Array.from(this.viewportsContainer.querySelectorAll(".sidebar-jlg-preview__viewport")).find(e=>!(!e||e.hasAttribute("hidden"))&&"mobile"===j.normalizePreviewSize(e.getAttribute("data-preview-size")))||("mobile"===this.previewSize?this.viewport:null)}positionTouchOverlay(e){if(!this.touchOverlay||!e||!this.container)return;const t=this.container.getBoundingClientRect(),i=e.getBoundingClientRect(),n=Math.max(0,i.left-t.left),s=Math.max(0,i.width);this.touchOverlay.style.setProperty("--sidebar-touch-left",`${n}px`),this.touchOverlay.style.setProperty("--sidebar-touch-width",`${s}px`)}updateSplitToggleState(){if(!this.splitToggle)return;const e=Boolean(this.splitViewEnabled);this.splitToggle.setAttribute("aria-pressed",e?"true":"false"),this.splitToggle.classList.toggle("is-active",e)}setSplitView(e){const t=Boolean(e);t!==this.splitViewEnabled&&(this.splitViewEnabled=t,this.container&&this.container.setAttribute("data-split-view",this.splitViewEnabled?"true":"false"),this.refreshSplitView(),this.updateSplitToggleState(),this.updateTouchOverlay(),!this.splitViewEnabled&&this.splitViewClones&&this.splitViewClones.length&&this.splitViewClones.forEach(e=>{e&&(e.setAttribute("hidden",""),e.setAttribute("aria-hidden","true"))}))}refreshSplitView(){if(!(this.splitViewEnabled&&this.splitViewClones&&this.splitViewClones.length&&this.viewport))return;const e=this.viewport.innerHTML,t=j.getPreviewOrder(this.previewSize);this.viewport&&void 0!==this.viewport.style&&(this.viewport.style.order=t),this.splitViewClones.forEach(t=>{if(!t)return;t.innerHTML=e;const i=j.normalizePreviewSize(t.getAttribute("data-preview-size")),n=this.getPreviewButtonLabel(i)||j.getPreviewLabel(i);t.setAttribute("data-preview-size",i),t.setAttribute("data-preview-label",n),this.replaceClass(t,"preview-",i),"function"==typeof t.setAttribute&&(t.setAttribute("aria-hidden","true"),t.setAttribute("inert","")),i===this.previewSize?t.setAttribute("hidden",""):t.removeAttribute("hidden"),void 0!==t.style&&(t.style.order=j.getPreviewOrder(i)),t.querySelectorAll("a, button, input, select, textarea, [tabindex]").forEach(e=>{e.setAttribute("tabindex","-1"),e.setAttribute("aria-hidden","true")})})}populateBreakpointInputs(){this.breakpointInputs&&this.breakpointInputs.length&&this.breakpointInputs.forEach(e=>{if(!e)return;const t=j.normalizeBreakpointKey(e.getAttribute("data-breakpoint-input"));t&&Object.prototype.hasOwnProperty.call(this.breakpoints,t)&&(e.value=this.breakpoints[t])})}applyBreakpointVariables(){if(!this.container)return;const e={mobile:"--sidebar-preview-width-mobile",tablet:"--sidebar-preview-width-tablet",desktop:"--sidebar-preview-width-desktop"};Object.keys(e).forEach(t=>{const i=e[t],n=this.breakpoints[t];Number.isFinite(n)&&n>0&&(this.container.style.setProperty(i,`${n}px`),this.container.setAttribute(`data-breakpoint-${t}`,String(n)))})}setupBreakpointControls(){!this.breakpointsInitialized&&this.breakpointInputs&&this.breakpointInputs.length&&(this.breakpointInputs.forEach(e=>{e&&(e.addEventListener("input",()=>{this.handleBreakpointInput(e,{previewOnly:!0})}),e.addEventListener("change",()=>{this.handleBreakpointInput(e)}))}),this.breakpointsInitialized=!0)}handleBreakpointInput(e,t={}){if(!e)return;const i=j.normalizeBreakpointKey(e.getAttribute("data-breakpoint-input"));if(!i)return;const n=this.breakpoints[i],s=j.parseBreakpoint(e.value,n);!Number.isFinite(s)||s<=0?e.value=n:(this.breakpoints[i]=s,this.applyBreakpointVariables(),t&&t.previewOnly||this.refreshSplitView(),this.updateTouchOverlay())}detachObservers(){this.menuObserver&&(this.menuObserver.disconnect(),this.menuObserver=null),this.socialObserver&&(this.socialObserver.disconnect(),this.socialObserver=null),this.menuContainer&&(this.menuContainer.removeEventListener("input",this.updateMenuFromDomBound),this.menuContainer.removeEventListener("change",this.updateMenuFromDomBound)),this.socialContainer&&(this.socialContainer.removeEventListener("input",this.updateSocialFromDomBound),this.socialContainer.removeEventListener("change",this.updateSocialFromDomBound))}setupBindings(){this.detachObservers(),this.form&&(this.isInitializing=!0,this.captureFontStacksFromDom(),this.bindField("sidebar_jlg_settings[style_preset]",e=>{this.currentOptions.style_preset=e||"custom"}),this.bindField("sidebar_jlg_settings[layout_style]",e=>{this.currentOptions.layout_style=e||"full"}),this.bindField("sidebar_jlg_settings[sidebar_position]",e=>{this.currentOptions.sidebar_position="right"===e?"right":"left"}),this.bindField("sidebar_jlg_settings[horizontal_bar_position]",e=>{this.currentOptions.horizontal_bar_position="bottom"===e?"bottom":"top"}),this.bindField("sidebar_jlg_settings[horizontal_bar_alignment]",e=>{this.currentOptions.horizontal_bar_alignment=e||"space-between"}),this.bindField("sidebar_jlg_settings[horizontal_bar_sticky]",e=>{this.currentOptions.horizontal_bar_sticky=!0===e||"1"===e||"on"===e}),this.bindField("sidebar_jlg_settings[bg_color]",e=>{this.currentOptions.bg_color=e}),this.bindField("sidebar_jlg_settings[bg_color_type]",e=>{this.currentOptions.bg_color_type=e}),this.bindField("sidebar_jlg_settings[bg_color_start]",e=>{this.currentOptions.bg_color_start=e}),this.bindField("sidebar_jlg_settings[bg_color_end]",e=>{this.currentOptions.bg_color_end=e}),this.bindField("sidebar_jlg_settings[font_color]",e=>{this.currentOptions.font_color=e}),this.bindField("sidebar_jlg_settings[font_hover_color]",e=>{this.currentOptions.font_hover_color=e}),this.bindField("sidebar_jlg_settings[font_size]",e=>{this.currentOptions.font_size=e}),this.bindField("sidebar_jlg_settings[font_family]",(e,t)=>{if(this.currentOptions.font_family=e,Array.isArray(t)&&t.length){const t=this.lookupFontStack(e);this.currentOptions.font_stack=t}else this.currentOptions.font_stack=this.lookupFontStack(e)}),this.bindField("sidebar_jlg_settings[font_weight]",e=>{this.currentOptions.font_weight=e}),this.bindField("sidebar_jlg_settings[text_transform]",e=>{this.currentOptions.text_transform=e||"none"}),this.bindField("sidebar_jlg_settings[accent_color]",e=>{this.currentOptions.accent_color=e}),this.bindField("sidebar_jlg_settings[accent_color_type]",e=>{this.currentOptions.accent_color_type=e}),this.bindField("sidebar_jlg_settings[accent_color_start]",e=>{this.currentOptions.accent_color_start=e}),this.bindField("sidebar_jlg_settings[accent_color_end]",e=>{this.currentOptions.accent_color_end=e}),this.bindField("sidebar_jlg_settings[mobile_bg_color]",e=>{this.currentOptions.mobile_bg_color=e}),this.bindField("sidebar_jlg_settings[mobile_bg_opacity]",e=>{this.currentOptions.mobile_bg_opacity=e}),this.bindField("sidebar_jlg_settings[mobile_blur]",e=>{this.currentOptions.mobile_blur=e}),this.bindField("sidebar_jlg_settings[width_desktop]",e=>{this.currentOptions.width_desktop=e}),this.bindField("sidebar_jlg_settings[width_tablet]",e=>{this.currentOptions.width_tablet=e}),this.bindField("sidebar_jlg_settings[width_mobile]",e=>{this.currentOptions.width_mobile=e}),this.bindDimensionField("sidebar_jlg_settings[horizontal_bar_height]","horizontal_bar_height"),this.bindField("sidebar_jlg_settings[overlay_color]",e=>{this.currentOptions.overlay_color=e}),this.bindField("sidebar_jlg_settings[overlay_opacity]",e=>{this.currentOptions.overlay_opacity=e}),this.bindField("sidebar_jlg_settings[hamburger_color]",e=>{this.currentOptions.hamburger_color=e}),this.bindDimensionField("sidebar_jlg_settings[hamburger_top_position]","hamburger_top_position"),this.bindDimensionField("sidebar_jlg_settings[hamburger_horizontal_offset]","hamburger_horizontal_offset"),this.bindDimensionField("sidebar_jlg_settings[hamburger_size]","hamburger_size"),this.bindDimensionField("sidebar_jlg_settings[content_margin]","content_margin"),this.bindDimensionField("sidebar_jlg_settings[floating_vertical_margin]","floating_vertical_margin"),this.bindDimensionField("sidebar_jlg_settings[border_radius]","border_radius"),this.bindDimensionField("sidebar_jlg_settings[letter_spacing]","letter_spacing"),this.bindField("sidebar_jlg_settings[border_width]",e=>{this.currentOptions.border_width=e}),this.bindField("sidebar_jlg_settings[border_color]",e=>{this.currentOptions.border_color=e}),this.bindField("sidebar_jlg_settings[menu_alignment_desktop]",e=>{this.currentOptions.menu_alignment_desktop=e||"flex-start"}),this.bindField("sidebar_jlg_settings[menu_alignment_mobile]",e=>{this.currentOptions.menu_alignment_mobile=e||"flex-start"}),this.bindField("sidebar_jlg_settings[app_name]",e=>{this.currentOptions.app_name=e}),this.bindField("sidebar_jlg_settings[nav_aria_label]",e=>{this.currentOptions.nav_aria_label=e}),this.bindField("sidebar_jlg_settings[toggle_open_label]",e=>{this.currentOptions.toggle_open_label=e}),this.bindField("sidebar_jlg_settings[toggle_close_label]",e=>{this.currentOptions.toggle_close_label=e}),this.bindField("sidebar_jlg_settings[header_logo_type]",e=>{this.currentOptions.header_logo_type=e}),this.bindField("sidebar_jlg_settings[header_logo_image]",e=>{this.currentOptions.header_logo_image=e}),this.bindField("sidebar_jlg_settings[header_logo_size]",e=>{this.currentOptions.header_logo_size=e}),this.bindField("sidebar_jlg_settings[header_alignment_desktop]",e=>{this.currentOptions.header_alignment_desktop=e||"flex-start"}),this.bindField("sidebar_jlg_settings[header_alignment_mobile]",e=>{this.currentOptions.header_alignment_mobile=e||"center"}),this.bindDimensionField("sidebar_jlg_settings[header_padding_top]","header_padding_top"),this.bindField("sidebar_jlg_settings[social_position]",e=>{this.currentOptions.social_position=e||"footer"}),this.bindField("sidebar_jlg_settings[social_orientation]",e=>{this.currentOptions.social_orientation=e||"horizontal"}),this.bindField("sidebar_jlg_settings[social_icon_size]",e=>{this.currentOptions.social_icon_size=e}),this.isInitializing=!1,this.menuContainer=document.getElementById("menu-items-container"),this.menuContainer&&(this.menuContainer.addEventListener("input",this.updateMenuFromDomBound),this.menuContainer.addEventListener("change",this.updateMenuFromDomBound),this.menuObserver=new MutationObserver(()=>this.updateMenuFromDom()),this.menuObserver.observe(this.menuContainer,{childList:!0,subtree:!0})),this.socialContainer=document.getElementById("social-icons-container"),this.socialContainer&&(this.socialContainer.addEventListener("input",this.updateSocialFromDomBound),this.socialContainer.addEventListener("change",this.updateSocialFromDomBound),this.socialObserver=new MutationObserver(()=>this.updateSocialFromDom()),this.socialObserver.observe(this.socialContainer,{childList:!0,subtree:!0})),this.updateMenuFromDom(),this.updateSocialFromDom())}bindField(e,t){if(!this.form)return;const i=`[name="${e.replace(/"/g,'"')}"]`,n=Array.from(this.form.querySelectorAll(i));if(!n.length)return;const s=()=>{const e=this.getFieldValue(n);t(e,n),this.isInitializing||this.applyOptions()};n.forEach(e=>{const t="radio"===e.type||"checkbox"===e.type?"change":"input";e.addEventListener(t,s)}),s()}bindDimensionField(e,t){if(!this.form)return;const i=e.replace(/"/g,'"'),n=`[name="${i}[value]"]`,s=`[name="${i}[unit]"]`,r=this.form.querySelector(n),a=this.form.querySelector(s);if(!r||!a)return;const o=()=>{const e=this.initialOptions[t]&&"string"==typeof this.initialOptions[t].unit?this.initialOptions[t].unit:"px",i=y({value:r.value,unit:a.value},e);this.currentOptions[t]=i,this.isInitializing||this.applyOptions()};r.addEventListener("input",o),r.addEventListener("change",o),a.addEventListener("input",o),a.addEventListener("change",o),o()}getFieldValue(e){if(!e.length)return null;if(e.length>1&&"radio"===e[0].type){const t=e.find(e=>e.checked);return t?t.value:null}const t=e[0];return"checkbox"===t.type?!!t.checked&&(t.value||!0):t.value}applyOptions(){this.applyCssVariables(),this.updateLayout(),this.updateHeader(),this.renderMenu(),this.renderSocial(),this.updateAccessibilityLabels()}applyCssVariables(){if(!this.container)return;[["--sidebar-bg-color",this.currentOptions.bg_color],["--sidebar-text-color",this.currentOptions.font_color],["--sidebar-hover-color",this.currentOptions.font_hover_color],["--sidebar-width-desktop",this.formatDimension(this.currentOptions.width_desktop)],["--sidebar-width-tablet",this.formatDimension(this.currentOptions.width_tablet)],["--sidebar-width-mobile",this.formatDimension(this.currentOptions.width_mobile)],["--sidebar-overlay-color",this.currentOptions.overlay_color],["--sidebar-overlay-opacity",this.formatOpacity(this.currentOptions.overlay_opacity)],["--sidebar-hamburger-color",this.currentOptions.hamburger_color],["--sidebar-hamburger-top",this.formatDimension(this.currentOptions.hamburger_top_position)],["--sidebar-hamburger-inline",this.formatDimension(this.currentOptions.hamburger_horizontal_offset)],["--sidebar-hamburger-size",this.formatDimension(this.currentOptions.hamburger_size)],["--sidebar-content-margin",this.formatDimension(this.currentOptions.content_margin)],["--sidebar-floating-margin",this.formatDimension(this.currentOptions.floating_vertical_margin)],["--sidebar-border-radius",this.formatDimension(this.currentOptions.border_radius)],["--sidebar-border-width",this.formatDimension(this.currentOptions.border_width)],["--sidebar-border-color",this.currentOptions.border_color],["--sidebar-menu-align-desktop",this.currentOptions.menu_alignment_desktop],["--sidebar-menu-align-mobile",this.currentOptions.menu_alignment_mobile],["--sidebar-social-size",this.formatPercent(this.currentOptions.social_icon_size)],["--sidebar-font-size",this.formatDimension(this.currentOptions.font_size)],["--sidebar-font-family",this.resolveFontFamily()],["--sidebar-font-weight",this.currentOptions.font_weight],["--sidebar-text-transform",this.currentOptions.text_transform],["--sidebar-letter-spacing",this.formatDimension(this.currentOptions.letter_spacing)],["--mobile-bg-color",this.currentOptions.mobile_bg_color],["--mobile-bg-opacity",this.formatOpacity(this.currentOptions.mobile_bg_opacity)],["--mobile-blur",this.formatDimension(this.currentOptions.mobile_blur)],["--sidebar-accent-color",this.resolveAccentBaseColor()],["--sidebar-logo-size",this.formatDimension(this.currentOptions.header_logo_size)],["--sidebar-header-align-desktop",this.currentOptions.header_alignment_desktop],["--sidebar-header-align-mobile",this.currentOptions.header_alignment_mobile],["--sidebar-header-padding-top",this.formatDimension(this.currentOptions.header_padding_top)],["--sidebar-horizontal-alignment",this.currentOptions.horizontal_bar_alignment],["--sidebar-horizontal-bar-height",this.formatDimension(this.currentOptions.horizontal_bar_height)]].forEach(([e,t])=>{null==t||""===t?this.container.style.removeProperty(e):this.container.style.setProperty(e,t)});const e=(this.currentOptions.bg_color_type||"solid").toLowerCase(),t=this.currentOptions.bg_color_start||"",i=this.currentOptions.bg_color_end||"";"gradient"===e&&t&&i?(this.container.style.setProperty("--sidebar-bg-image",`linear-gradient(180deg, ${t} 0%, ${i} 100%)`),this.container.style.setProperty("--sidebar-bg-color",t)):(this.container.style.setProperty("--sidebar-bg-image","none"),this.currentOptions.bg_color&&this.container.style.setProperty("--sidebar-bg-color",this.currentOptions.bg_color)),this.applyAccentGradient()}formatDimension(e){if(null==e)return"";if("object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"value"))return function(e,t=""){if(null==e)return t;if("string"==typeof e)return e.trim();if("number"==typeof e)return Number.isFinite(e)?`${e}px`:t;if("object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"value")){const i=f(e.value);return""===i?t:`${i}${"string"==typeof e.unit?e.unit:""}`}return t}(e,"");if(""===e)return"";if("number"==typeof e)return Number.isFinite(e)?`${e}px`:"";const t=String(e).trim();return""===t?"":/^-?\d+(?:\.\d+)?$/.test(t)?`${t}px`:t}formatOpacity(e){const t=parseFloat(e);return Number.isFinite(t)?Math.min(1,Math.max(0,t)).toString():"0.5"}formatPercent(e){return null==e||""===e?"100%":"number"==typeof e||/^-?\d+(?:\.\d+)?$/.test(String(e))?`${e}%`:String(e)}updateLayout(){if(!this.aside)return;const e=this.currentOptions.layout_style||"full",t="right"===this.currentOptions.sidebar_position?"right":"left",i="bottom"===this.currentOptions.horizontal_bar_position?"bottom":"top",n=this.currentOptions.horizontal_bar_alignment||"space-between",s=Boolean(this.currentOptions.horizontal_bar_sticky);this.replaceClass(this.aside,"layout-",e),this.replaceClass(this.aside,"orientation-",t),this.replaceClass(this.aside,"position-","horizontal-bar"===e?i:""),"horizontal-bar"===e&&s?this.aside.classList.add("is-sticky"):this.aside.classList.remove("is-sticky"),this.menuList&&("horizontal-bar"===e?this.menuList.classList.add("is-horizontal"):this.menuList.classList.remove("is-horizontal")),this.nav&&("horizontal-bar"===e?this.nav.classList.add("is-horizontal"):this.nav.classList.remove("is-horizontal")),this.hamburger&&(this.hamburger.dataset.position=t),this.aside.dataset.position=t,this.aside.dataset.horizontalAlignment=n,this.aside.dataset.layout=e}replaceClass(e,t,i){if(!e)return;const n=i?`${t}${String(i).toLowerCase()}`:"",s=[];e.classList.forEach(e=>{0===e.indexOf(t)&&s.push(e)}),s.forEach(t=>e.classList.remove(t)),n&&e.classList.add(n)}updateHeader(){if(!this.viewport)return;const e=this.viewport.querySelector(".sidebar-header");if(!e)return;const t=this.currentOptions.header_logo_type,i=this.currentOptions.header_logo_image,n=this.currentOptions.app_name||"";let s=e.querySelector(".sidebar-logo-image"),r=e.querySelector(".logo-text");"image"===t&&i?(s||(s=document.createElement("img"),s.className="sidebar-logo-image",e.insertBefore(s,e.firstChild)),s.src=i,s.alt=n,r&&r.remove()):(r||(r=document.createElement("span"),r.className="logo-text",e.insertBefore(r,e.firstChild)),r.textContent=n,s&&s.remove())}updateMenuFromDom(){const e=[];this.menuContainer&&this.menuContainer.querySelectorAll(".menu-item-box").forEach(t=>{const i=t.querySelector(".item-label"),n=i&&"string"==typeof i.value?i.value.trim():"";let s="#";const r=t.querySelector('input[name*="[value]"]'),a=t.querySelector('select[name*="[value]"]');r&&"string"==typeof r.value&&""!==r.value.trim()?s=r.value.trim():a&&"string"==typeof a.value&&""!==a.value.trim()&&(s=a.value.trim());const o=t.querySelector(".menu-item-icon-wrapper .icon-preview"),l=o?o.innerHTML:"";e.push({label:n,url:s,iconHtml:l})}),this.currentOptions.menu_items=e,this.renderMenu()}escapeHtml(e){return String(e||"").replace(/[&<>"']/g,e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";default:return e}})}buildMenuItem(e){const t=document.createElement("li"),i=document.createElement("a");if(i.href="#",i.dataset.previewUrl=e.url||"#",i.addEventListener("click",e=>e.preventDefault()),e.iconHtml){const t=document.createElement("span");t.className="menu-icon",t.innerHTML=e.iconHtml,i.appendChild(t)}const n=document.createElement("span");return n.textContent=e.label||e.url||"#",i.appendChild(n),t.appendChild(i),t}renderMenu(){if(!this.menuList)return;const e=Array.isArray(this.currentOptions.menu_items)?this.currentOptions.menu_items:[],t=this.menuSocialItem&&this.menuSocialItem.parentElement===this.menuList?this.menuSocialItem:null;if(t&&this.menuList.removeChild(t),this.menuList.innerHTML="",e.length){const t=document.createDocumentFragment();e.forEach(e=>{t.appendChild(this.buildMenuItem(e))}),this.menuList.appendChild(t)}else{const e=document.createElement("li");e.className="menu-empty-message",e.textContent=this.messages.emptyMenu||"",this.menuList.appendChild(e)}t&&this.menuList.appendChild(t)}updateSocialFromDom(){const e=[];this.socialContainer&&this.socialContainer.querySelectorAll(".menu-item-box").forEach(t=>{const i=t.querySelector(".social-url"),n=t.querySelector(".icon-preview"),s=t.querySelector(".item-label"),r=i&&"string"==typeof i.value?i.value.trim():"";r&&e.push({url:r,iconHtml:n?n.innerHTML:"",label:s&&"string"==typeof s.value?s.value.trim():""})}),this.currentOptions.social_icons=e,this.renderSocial()}buildSocialMarkup(e,t){if(!Array.isArray(e)||!e.length)return"";const i="vertical"===t?"vertical":"horizontal",n=e.filter(e=>e&&e.url).map(e=>{const t=this.escapeHtml(e.label||e.url),i=e.iconHtml&&""!==e.iconHtml.trim()?e.iconHtml:`<span class="no-icon-label">${t}</span>`;return`<a href="#" data-preview-url="${this.escapeHtml(e.url)}" aria-label="${t}">${i}</a>`}).join("");return n?`<div class="social-icons ${i}">${n}</div>`:""}renderSocial(){const e=Array.isArray(this.currentOptions.social_icons)?this.currentOptions.social_icons:[],t="in-menu"===this.currentOptions.social_position?"in-menu":"footer",i=this.currentOptions.social_orientation||"horizontal",n=this.buildSocialMarkup(e,i);if("in-menu"===t){if(!this.menuList)return;this.menuSocialItem||(this.menuSocialItem=document.createElement("li"),this.menuSocialItem.className="social-icons-wrapper"),this.menuSocialItem.innerHTML=n,this.menuSocialItem.style.display=n?"":"none",this.menuList.contains(this.menuSocialItem)||this.menuList.appendChild(this.menuSocialItem),this.footerSocial&&(this.footerSocial.style.display="none")}else{if(!this.footerSocial&&this.aside){const e=this.aside.querySelector(".sidebar-inner");this.footerSocial=document.createElement("div"),this.footerSocial.className="sidebar-footer",e?e.appendChild(this.footerSocial):this.aside.appendChild(this.footerSocial)}this.footerSocial&&(this.footerSocial.innerHTML=n,this.footerSocial.style.display=n?"":"none"),this.menuSocialItem&&this.menuSocialItem.parentElement&&this.menuSocialItem.parentElement.removeChild(this.menuSocialItem)}}updateAccessibilityLabels(){const e="string"==typeof this.currentOptions.nav_aria_label?this.currentOptions.nav_aria_label.trim():"",t=""!==e?e:this.defaultNavAriaLabel||"";this.nav&&(t?this.nav.setAttribute("aria-label",t):this.nav.removeAttribute("aria-label"));const i="string"==typeof this.currentOptions.toggle_open_label?this.currentOptions.toggle_open_label.trim():"",n="string"==typeof this.currentOptions.toggle_close_label?this.currentOptions.toggle_close_label.trim():"",s=""!==i?i:this.defaultToggleExpandLabel||"",r=""!==n?n:this.defaultToggleCollapseLabel||"";this.menuList&&this.menuList.querySelectorAll(".submenu-toggle").forEach(e=>{s?e.setAttribute("data-label-expand",s):e.removeAttribute("data-label-expand"),r?e.setAttribute("data-label-collapse",r):e.removeAttribute("data-label-collapse");const t="true"===e.getAttribute("aria-expanded")?r:s;t?e.setAttribute("aria-label",t):e.removeAttribute("aria-label");const i=e.querySelector(".screen-reader-text");i&&(i.textContent=t||"")})}}jQuery(document).ready(function(t){const a=sidebarJLG.options||{},l=sidebarJLG.ajax_url||"",c=sidebarJLG.nonce||"",d="string"==typeof sidebarJLG.icon_fetch_action?sidebarJLG.icon_fetch_action:"jlg_get_icon_svg",u="string"==typeof sidebarJLG.tools_nonce?sidebarJLG.tools_nonce:"";let p=Array.isArray(sidebarJLG.icons_manifest)?sidebarJLG.icons_manifest:[];const h="string"==typeof sidebarJLG.icon_upload_action?sidebarJLG.icon_upload_action:"",m=parseInt(sidebarJLG.icon_upload_max_size,10),g=!isNaN(m)&&m>0?m:0,C="1"==a.debug_mode,E={posts:{},categories:{}},O={},A={},L={},F={};b({container:document.querySelector("[data-widget-builder]"),hiddenField:document.getElementById("sidebar-jlg-widgets-field"),schemas:sidebarJLG.widget_schemas||{}});const $="sidebarJlgExperienceMode",z={root:document.querySelector("[data-sidebar-experience]"),toggle:document.querySelector("[data-sidebar-mode-toggle]"),summary:document.querySelector("[data-sidebar-mode-summary]")},I=z.toggle?Array.from(z.toggle.querySelectorAll("[data-mode-value]")):[],T={mode:"simple",view:"form"};function P(e){return"expert"===e?"expert":"simple"}if(z.root){"canvas"===z.root.getAttribute("data-sidebar-experience-mode")&&(T.view="canvas");const e=z.root.getAttribute("data-sidebar-form-mode");"string"==typeof e&&""!==e&&(T.mode=P(e))}function N(){try{if(window.localStorage){const e=window.localStorage.getItem($);if("string"==typeof e&&""!==e)return"canvas"===e?(T.view="canvas","simple"):P(e)}}catch(e){}if(z.root&&"function"==typeof z.root.getAttribute){const e=z.root.getAttribute("data-sidebar-experience-mode");if("string"==typeof e&&""!==e)return"canvas"===e?(T.view="canvas","simple"):P(e)}return"simple"}function M(){return z.root?Array.from(z.root.querySelectorAll('[data-sidebar-mode="expert"]')):[]}function D(){if(!z.root)return;const e="canvas"===T.view?"canvas":T.mode;z.root.setAttribute("data-sidebar-experience-mode",e),z.root.setAttribute("data-sidebar-experience-view",T.view),"canvas"!==T.view&&z.root.setAttribute("data-sidebar-form-mode",T.mode),"form"===T.view&&M().forEach(e=>{"simple"===T.mode?(e.setAttribute("aria-hidden","true"),e.classList.add("is-experience-hidden")):(e.removeAttribute("aria-hidden"),e.classList.remove("is-experience-hidden"))}),I.length&&I.forEach(e=>{const t=P(e.getAttribute("data-mode-value")),i="form"===T.view&&t===T.mode;e.classList.toggle("is-active",i),e.setAttribute("aria-pressed",i?"true":"false")}),function(){if(!z.summary)return;if("canvas"===T.view){const e=s("canvasModeSummary","Mode canvas : pilotez la sidebar en glisser-déposer.");return void(z.summary.textContent=e)}if("expert"===T.mode){const e=s("experienceModeExpertSummary","Mode expert : toutes les options sont visibles.");return void(z.summary.textContent=e)}const e=M().length,t=s("experienceModeSimpleSummary","Mode simple : %d option(s) avancée(s) masquée(s).");z.summary.textContent=t.replace("%d",e)}()}function q(e,{persist:t=!1}={}){if("canvas"===e)return void B("canvas");const i=P(e);T.mode!==i&&(T.mode=i,t&&function(e){if("canvas"!==e)try{window.localStorage&&window.localStorage.setItem($,e)}catch(e){}}(i)),"form"===T.view?D():B("form")}function B(e){const t="canvas"===e?"canvas":"form";return T.view!==t&&(T.view=t,D()),T.view}I.length?(I.forEach(e=>{e.addEventListener("click",()=>{q(e.getAttribute("data-mode-value"),{persist:!0})})}),q(N())):q(N());let G=null,V=null;const U=new j({container:document.getElementById("sidebar-jlg-preview"),form:document.getElementById("sidebar-jlg-form"),ajaxUrl:l,nonce:sidebarJLG.preview_nonce||"",action:sidebarJLG.preview_action||"jlg_render_preview",options:a,messages:sidebarJLG.preview_messages||{}}),J=U.loadPreview.bind(U);U.loadPreview=function(...e){return J(...e).then(e=>(G&&"function"==typeof G.updateActiveProfileStatusMessage?G.updateActiveProfileStatusMessage():V&&V.then(e=>{e&&"function"==typeof e.updateActiveProfileStatusMessage&&e.updateActiveProfileStatusMessage()}),e))},U.init(),function(){const e=!!(window.wp&&wp.element&&wp.components&&wp.components.UnitControl);let t,i,n,s;e&&(({createElement:t,useMemo:i,useState:n}=wp.element),({UnitControl:s}=wp.components)),document.querySelectorAll("[data-sidebar-unit-control]").forEach(r=>{const a=r.querySelector("input[data-dimension-value]"),o=r.querySelector("input[data-dimension-unit]");if(!a||!o)return;const l=r.dataset.label||"",c=r.dataset.help||"",d=r.dataset.errorMessage||"",u=r.dataset.defaultValue||"",p=r.dataset.defaultUnit||"px",h=function(e){if("string"!=typeof e||""===e.trim())return[];try{const t=JSON.parse(e);return Array.isArray(t)?t.filter(e=>"string"==typeof e&&""!==e.trim()).map(e=>e.trim()):[]}catch(e){return[]}}(r.dataset.allowedUnits||""),m=y({value:a.value,unit:o.value},p,h),g=y({value:u,unit:p},p,h);e?wp.element.render(t(()=>{const[e,r]=n(m.value),[u,b]=n(m.unit),[_,w]=n(""),S=i(()=>(h&&h.length?h:[m.unit||g.unit||p]).map(e=>({value:e,label:e})),[h,m.unit,g.unit]);return t(s,{label:l,value:""===e?"":parseFloat(e),unit:u,units:S,onChange:e=>{const t=f(e);""===t?(r(""),a.value="",w(d||c)):(r(t),a.value=t,w("")),v(a)},onUnitChange:t=>{const i=y({value:e||g.value,unit:t},p,h).unit;b(i),o.value=i,v(o)},onBlur:()=>{if(""===e){const e=""!==g.value?g.value:"0",t=g.unit||u||p;r(e),a.value=e;const i=y({value:e,unit:t},p,h).unit;b(i),o.value=i,w(""),v(a),v(o)}},isInvalid:""===e,help:_||c})}),r):function(e,t){const{valueInput:i,unitInput:n,label:s,helpText:r,errorMessage:a,allowedUnits:o,initialDimension:l,defaultDimension:c,defaultUnit:d}=t,u=document.createElement("div");u.className="sidebar-jlg-unit-control__fallback";const p=`${(e.dataset.settingName||i.name||"sidebar-unit").toLowerCase().replace(/[^a-z0-9_-]+/g,"-")||"sidebar-unit"}-${Math.random().toString(36).slice(2,8)}`,h=`${p}-value`,m=`${p}-unit`,g=`${p}-help`,b=`${p}-feedback`,y=document.createElement("label");y.className="sidebar-jlg-unit-control__fallback-label",y.setAttribute("for",h),y.textContent=s||"",u.appendChild(y);const _=document.createElement("div");_.className="sidebar-jlg-unit-control__fallback-controls";const w=document.createElement("input");w.type="number",w.className="sidebar-jlg-unit-control__fallback-input",w.id=h,w.step="0.1";const S=o&&o.length?o:[l.unit||c.unit||d||"px"],x=document.createElement("select");x.className="sidebar-jlg-unit-control__fallback-select",x.id=m,S.forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e,x.appendChild(t)});const k=""!==l.value?l.value:""!==c.value?c.value:"0";w.value=k,i.value=f(k);const j=l.unit||c.unit||d||S[0];x.value=j,n.value=j;const C=[],E=document.createElement("p");E.className="description",E.id=g,E.textContent=r||"",""!==E.textContent&&C.push(g);const O=document.createElement("p");if(O.className="sidebar-jlg-unit-control__fallback-feedback",O.id=b,O.setAttribute("aria-live","polite"),O.textContent="",a&&C.push(b),C.length){const e=C.join(" ");w.setAttribute("aria-describedby",e),x.setAttribute("aria-describedby",e)}const A=e=>{O.textContent=e||""};w.addEventListener("input",()=>{const e=f(w.value);""===e?(i.value="",A(a||r||"")):(i.value=e,A("")),v(i)}),w.addEventListener("blur",()=>{if(""===i.value){const e=""!==c.value?c.value:"0";i.value=e,w.value=e,A(""),v(i)}}),x.addEventListener("change",()=>{const e=x.value;n.value=e,v(n)}),_.appendChild(w),_.appendChild(x),u.appendChild(_),""!==E.textContent&&u.appendChild(E),a&&u.appendChild(O),e.appendChild(u)}(r,{valueInput:a,unitInput:o,label:l,helpText:c,errorMessage:d,allowedUnits:h,initialDimension:m,defaultDimension:g,defaultUnit:p})})}(),function(){if(!(window.wp&&wp.element&&wp.components&&wp.components.RangeControl))return;const{createElement:e,useState:t}=wp.element,{RangeControl:i}=wp.components;document.querySelectorAll("[data-sidebar-range-control]").forEach(n=>{const s=n.querySelector("input[data-range-value]");if(!s)return;const r=n.dataset.label||"",a=n.dataset.help||"",o=n.dataset.errorMessage||"",l=Number.parseFloat(n.dataset.min),c=Number.parseFloat(n.dataset.max),d=Number.parseFloat(n.dataset.step),u=Number.isFinite(l)?l:0,p=Number.isFinite(c)?c:1,h=Number.isFinite(d)&&d>0?d:.01,m=Number.parseFloat(s.value),g=Number.isFinite(m)?m:u;s.value=f(g),wp.element.render(e(()=>{const[n,l]=t(g),[c,d]=t("");return e(i,{label:r,value:n,onChange:e=>{const t="number"==typeof e?e:Number.parseFloat(e);if(!Number.isFinite(t))return void d(o||a);const i=Math.min(p,Math.max(u,t)),n=parseFloat(i.toFixed(3));l(n),s.value=f(n),d(""),v(s)},min:u,max:p,step:h,help:c||a,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}),n)})}(),function(){const e=t("[data-sidebar-accessibility]");if(!e.length)return;const i=document.documentElement&&document.documentElement.lang||void 0,n="undefined"!=typeof Intl&&Intl.NumberFormat?new Intl.NumberFormat(i,{maximumFractionDigits:0}):null,r=e=>{if("number"!=typeof e||!Number.isFinite(e))return"0";if(n)try{return n.format(e)}catch(t){return String(Math.round(e))}return String(Math.round(e))},a=s("accessibilityOverviewValue","%1$s critères sur %2$s (%3$s%%)");e.each(function(){const e=t(this),i=String(e.data("progressTemplate")||""),n=String(e.data("progressAriaTemplate")||""),s=parseInt(e.data("totalItems"),10),o=Number.isFinite(s)&&s>0?s:0,l=e.find("[data-accessibility-context-switcher]"),c=e.find("[data-accessibility-overview]"),d=[];if(e.find("[data-accessibility-context]").each(function(){const e=t(this),s=String(e.data("accessibilityContext")||"");if(!s)return;const r=e.find('input[type="checkbox"]'),a=String(e.data("progressTemplate")||i),l=String(e.data("progressAriaTemplate")||n),c=parseInt(e.data("totalItems"),10),u=Number.isFinite(c)&&c>0?c:o>0?o:r.length;d.push({key:s,element:e,checkboxes:r,status:e.find("[data-accessibility-progress-status]"),meter:e.find("[data-accessibility-progress-meter]"),template:a,ariaTemplate:l,totalItems:u})}),!d.length)return;const u=e=>{c.length&&c.find("[data-accessibility-overview-item]").each(function(){const i=t(this),n=String(i.data("accessibilityOverviewItem")||"");i.toggleClass("is-active",n===e)})},p=e=>{let i=0;e.checkboxes.each(function(){t(this).prop("checked")&&(i+=1)});const n=e.totalItems>0?e.totalItems:e.checkboxes.length,s=n>0?Math.round(i/n*100):0,o=((e,t,i,n)=>e?e.replace("%1$s",r(t)).replace("%2$s",r(i)).replace("%3$s",r(n)):`${r(t)} / ${r(i)} (${r(n)}%)`)(e.template,i,n,s),l=((e,t)=>e?e.replace("%1$s",r(t)):`${r(t)}%`)(e.ariaTemplate,s);return e.status.length&&e.status.text(o),e.meter.length&&(e.meter.attr("value",i),e.meter.attr("max",n),e.meter.attr("aria-label",l)),((e,i,n,s)=>{const o=(e=>c.length?c.find(`[data-accessibility-overview-item="${e}"]`):t())(e);if(!o.length)return;o.attr("data-completed",i),o.attr("data-percent",s);const l=a.replace("%1$s",r(i)).replace("%2$s",r(n)).replace("%3$s",r(s)),d=o.find(".sidebar-jlg-accessibility__context-overview-value");d.length?d.text(l):o.text(l)})(e.key,i,n,s),{completed:i,total:n,percent:s}};let h="";const m=e=>{h=e,d.forEach(t=>{const i=t.key===e;t.element.toggleClass("is-active",i),i?(t.element.removeAttr("hidden"),t.element.attr("aria-hidden","false")):(t.element.attr("hidden","hidden"),t.element.attr("aria-hidden","true"))}),u(e)};d.forEach(e=>{const t=()=>{p(e)};e.checkboxes.on("change",t),t()});const g=(()=>{if(l.length){const e=String(l.val()||"");if(e)return e}return d[0].key})();m(g),l.length&&l.on("change",function(){const e=String(t(this).val()||"");d.some(t=>t.key===e)&&m(e)})})}(),function(){const e=n();if(!e||!e.accessibility_audit)return;const i=e.accessibility_audit,r=e.ajax_url||"",a=t("#sidebar-jlg-accessibility-audit");if(!a.length)return;const o=a.find(".sidebar-jlg-accessibility-audit__url"),l=a.find(".sidebar-jlg-accessibility-audit__launch"),c=a.find(".sidebar-jlg-accessibility-audit__status"),d=t("#sidebar-jlg-audit-result"),u="string"==typeof i.default_url?i.default_url:"",p=l.length?l.text():"";o.length&&u&&"string"==typeof o.val()&&!o.val()&&o.val(u);const h={error:s("auditTypeError","Erreur"),warning:s("auditTypeWarning","Avertissement"),notice:s("auditTypeNotice","Notice")},m=(e,t="")=>{if(!c.length)return;const i="string"==typeof e?e:"";c.text(i),c.removeClass("is-error is-success is-info"),t&&c.addClass(`is-${t}`)},g=e=>{if(!d.length||!e)return;const i=s("auditLogTitle","Sortie technique"),n=s("auditSeeDetails","Afficher les détails"),r=s("auditHideDetails","Masquer les détails"),a=t("<details/>",{class:"sidebar-jlg-accessibility-audit__log"}),o=t("<summary/>"),l=t("<span/>",{class:"sidebar-jlg-accessibility-audit__log-title"});l.text(i);const c=t("<span/>",{class:"sidebar-jlg-accessibility-audit__log-toggle"});c.text(n),o.append(l).append(c),a.append(o);const u=t("<pre/>",{class:"sidebar-jlg-accessibility-audit__log-output"});u.text(e),a.append(u),a.on("toggle",function(){const e=a.prop("open");c.text(e?r:n)}),d.append(a)},b=(e,i)=>{if(!d.length)return;const n="string"==typeof i?i:s("auditGenericError","L’audit d’accessibilité a échoué.");d.removeAttr("hidden").removeClass("has-success").addClass("has-error").empty(),t("<p/>",{class:"sidebar-jlg-accessibility-audit__error"}).text(n).appendTo(d),e&&"string"==typeof e.log&&e.log&&g(e.log)};if(!i.is_available){const e=s("auditUnavailable","Pa11y n’est pas disponible sur ce serveur.");m(e,"error"),l.length&&l.prop("disabled",!0).attr("aria-disabled","true")}l.length&&l.on("click",function(){if(!r)return void W("error",s("auditGenericError","L’audit d’accessibilité a échoué."));if(!i.nonce)return void W("error",s("auditGenericError","L’audit d’accessibilité a échoué."));const e=o.length&&"string"==typeof o.val()?o.val().trim():"";if(!e){const e=s("auditMissingUrl","Veuillez saisir une URL à analyser.");return W("error",e),void m(e,"error")}m(s("auditRunning","Audit en cours…"),"info"),l.prop("disabled",!0).text(s("auditRunning","Audit en cours…")),a.addClass("is-running"),d.length&&d.attr("hidden","hidden").removeClass("has-success has-error").empty(),t.post(r,{action:i.action,nonce:i.nonce,target_url:e}).done(e=>{if(e&&e.success&&e.data)(e=>{if(!d.length)return;const i=e&&"object"==typeof e.summary?e.summary:{},n=e&&"object"==typeof e.meta?e.meta:{},r=Array.isArray(e&&e.issues)?e.issues:[],a=parseInt(i.error,10)||0,o=parseInt(i.warning,10)||0,l=parseInt(i.notice,10)||0,c=s("auditSummaryTemplate","%1$d erreur(s), %2$d avertissement(s), %3$d notice(s).").replace("%1$d",a).replace("%2$d",o).replace("%3$d",l);if(d.removeAttr("hidden").removeClass("has-error").addClass("has-success").empty(),t("<p/>",{class:"sidebar-jlg-accessibility-audit__summary"}).text(c).appendTo(d),n&&"string"==typeof n.page_url&&n.page_url){const e=t("<p/>",{class:"sidebar-jlg-accessibility-audit__meta"}),i=t("<a/>",{href:n.page_url,target:"_blank",rel:"noreferrer noopener",class:"sidebar-jlg-accessibility-audit__link"});i.text(n.page_url),e.append(i),d.append(e)}if(n&&"string"==typeof n.document_title&&n.document_title){const e=s("auditDocumentTitle","Titre de page : %s").replace("%s",n.document_title);t("<p/>",{class:"sidebar-jlg-accessibility-audit__meta"}).text(e).appendTo(d)}if(n&&void 0!==n.execution_time_ms){const e=Number(n.execution_time_ms);if(Number.isFinite(e)&&e>=0){const i=s("auditExecutionTime","Durée : %s ms").replace("%s",String(Math.round(e)));t("<p/>",{class:"sidebar-jlg-accessibility-audit__meta"}).text(i).appendTo(d)}}if(!r.length){const i=s("auditNoIssues","Pa11y n’a détecté aucun problème critique.");return t("<p/>",{class:"sidebar-jlg-accessibility-audit__success-message"}).text(i).appendTo(d),void(e&&"string"==typeof e.log&&e.log&&g(e.log))}const u=(e=>{const i=t("<ol/>",{class:"sidebar-jlg-accessibility-audit__issues"});return e.forEach(e=>{if(!e||"object"!=typeof e)return;const n="string"==typeof e.type?e.type:"notice",r="string"==typeof e.message?e.message:"",a="string"==typeof e.selector?e.selector:"",o="string"==typeof e.code?e.code:"",l="string"==typeof e.context?e.context:"",c=t("<li/>",{class:`sidebar-jlg-accessibility-audit__issue sidebar-jlg-accessibility-audit__issue--${n}`}),d=t("<div/>",{class:"sidebar-jlg-accessibility-audit__issue-header"}),u=t("<span/>",{class:"sidebar-jlg-accessibility-audit__issue-type"});if(u.text(h[n]||h.notice),d.append(u),r){const e=t("<span/>",{class:"sidebar-jlg-accessibility-audit__issue-message"});e.text(r),d.append(e)}if(c.append(d),o){const e=s("auditIssueCode","Code : %s").replace("%s",o),i=t("<p/>",{class:"sidebar-jlg-accessibility-audit__issue-code"});i.text(e),c.append(i)}if(a){const e=s("auditIssueSelector","Sélecteur : %s").replace("%s",a),i=t("<p/>",{class:"sidebar-jlg-accessibility-audit__issue-selector"});i.text(e),c.append(i)}if(l){const e=s("auditIssueContext","Extrait :"),i=t("<p/>",{class:"sidebar-jlg-accessibility-audit__issue-context-label"});i.text(e);const n=t("<pre/>",{class:"sidebar-jlg-accessibility-audit__issue-context"}),r=t("<code/>");r.text(l),n.append(r),c.append(i).append(n)}i.append(c)}),i})(r);u&&u.children().length&&d.append(u),e&&"string"==typeof e.log&&e.log&&g(e.log)})(e.data),m(s("auditCompleted","Audit terminé."),"success");else{const t=Q(e,s("auditGenericError","L’audit d’accessibilité a échoué."));b(e?e.data:null,t),m(t,"error")}}).fail(e=>{const t=Q(e?e.responseJSON:null,s("auditGenericError","L’audit d’accessibilité a échoué."));b(e?e.responseJSON:null,t),m(t,"error")}).always(()=>{a.removeClass("is-running"),l.prop("disabled",!i.is_available).text(p)})})}(),function(e){const t=document.getElementById("sidebar-jlg-style-preset"),i=document.getElementById("sidebar-jlg-style-presets");if(!t||!i)return;const n=i.querySelector("[data-style-preset-grid]");if(!n)return void(t.disabled=!1);t.disabled=!1;const r=i.querySelector("[data-style-preset-empty]"),o=s("stylePresetApplyLabel","Utiliser ce préréglage"),l=s("stylePresetCustomLabel","Personnalisé"),c=s("stylePresetCustomDescription","Utilisez vos propres combinaisons de couleurs, typographies et effets."),d=s("stylePresetEmpty","Aucun préréglage n’est disponible pour le moment.");r&&(r.textContent=d);const u="object"==typeof sidebarJLG.style_presets&&null!==sidebarJLG.style_presets?sidebarJLG.style_presets:{},p=Object.keys(u).map(e=>{const t=u[e]||{},i=t.preview&&"object"==typeof t.preview?t.preview:{};return{key:e,label:"string"==typeof t.label&&""!==t.label.trim()?t.label:e,description:"string"==typeof t.description?t.description:"",settings:t.settings&&"object"==typeof t.settings?t.settings:null,preview:{background:"string"==typeof i.background?i.background:"",accent:"string"==typeof i.accent?i.accent:"",text:"string"==typeof i.text?i.text:""}}});n.innerHTML="";let h=!1,m=null;const g=e=>{n.querySelectorAll(".sidebar-jlg-style-preset-card").forEach(t=>{const i=t.dataset.presetKey===e;t.classList.toggle("is-active",i),t.setAttribute("aria-pressed",i?"true":"false")}),i.setAttribute("data-selected-preset",e)},b=e=>{t.value=e,v(t)},f=()=>{const e=U&&U.currentOptions?U.currentOptions:a,t={background:"#1f2937",accent:"#0ea5e9",text:"#f8fafc"};if("gradient"===("string"==typeof e.bg_color_type?e.bg_color_type.toLowerCase():"solid")){const i=e.bg_color_start||e.bg_color||t.background,n=e.bg_color_end||i;t.background=`linear-gradient(180deg, ${i} 0%, ${n} 100%)`}else e.bg_color&&(t.background=e.bg_color);if("gradient"===("string"==typeof e.accent_color_type?e.accent_color_type.toLowerCase():"solid")){const i=e.accent_color_start||e.accent_color||t.accent,n=e.accent_color_end||i;t.accent=`linear-gradient(135deg, ${i} 0%, ${n} 100%)`}else e.accent_color&&(t.accent=e.accent_color);return e.font_color&&(t.text=e.font_color),t},y=()=>{if(!m)return;const e=m.querySelector(".sidebar-jlg-style-preset-card__preview"),t=m.querySelector(".sidebar-jlg-style-preset-card__accent"),i=m.querySelector(".sidebar-jlg-style-preset-card__sample");if(!e||!t||!i)return;const n=f();e.style.background=n.background,t.style.background=n.accent,i.style.color=n.text},_=t=>{h=!0,(()=>{if(!e||"function"!=typeof e.isActive)return Promise.resolve();try{if(e.isActive()&&"function"==typeof e.exit)return Promise.resolve(e.exit())}catch(e){return Promise.resolve()}return Promise.resolve()})().then(()=>{var e;return"custom"!==t.key&&t.settings&&(e=t.settings)&&"object"==typeof e&&Object.keys(e).forEach(t=>{const i=e[t];if(i&&"object"==typeof i&&Object.prototype.hasOwnProperty.call(i,"value")&&Object.prototype.hasOwnProperty.call(i,"unit")){const e=document.querySelector(`[name="sidebar_jlg_settings[${t}][value]"]`),n=document.querySelector(`[name="sidebar_jlg_settings[${t}][unit]"]`);return e&&(e.value=i.value,v(e)),void(n&&(n.value=i.unit,v(n)))}const n=document.querySelectorAll(`input[type="radio"][name="sidebar_jlg_settings[${t}]"]`);if(n.length){let e=null;return n.forEach(t=>{const n=t.value===String(i);t.checked=n,n&&(e=t)}),void(e?v(e):n[0]&&v(n[0]))}const s=document.querySelector(`input[type="checkbox"][name="sidebar_jlg_settings[${t}]"]`);if(s){const e=!0===i||"1"===i||1===i||"on"===i;return s.checked=e,void v(s)}const r=document.querySelector(`[name="sidebar_jlg_settings[${t}]"]`);if(r&&(r.value=i,v(r),window.jQuery)){const e=window.jQuery(r);"function"==typeof e.wpColorPicker&&e.data("wpColorPicker")?e.wpColorPicker("color",i):e.hasClass("color-picker-rgba")&&e.trigger("change")}}),b(t.key),g(t.key),U&&"function"==typeof U.loadPreview?U.loadPreview().then(()=>{U.applyOptions(),y()}).catch(()=>{y()}):(y(),Promise.resolve())}).catch(()=>{}).finally(()=>{h=!1})},w=[{key:"custom",label:l,description:c,settings:null,preview:f()},...p],S={};w.forEach(e=>{const t=(e=>{const t=document.createElement("button");t.type="button",t.className="sidebar-jlg-style-preset-card",t.dataset.presetKey=e.key,t.setAttribute("aria-pressed","false");const i=document.createElement("span");i.className="sidebar-jlg-style-preset-card__preview",e.preview.background&&(i.style.background=e.preview.background);const n=document.createElement("span");n.className="sidebar-jlg-style-preset-card__accent",e.preview.accent&&(n.style.background=e.preview.accent),i.appendChild(n);const s=document.createElement("span");s.className="sidebar-jlg-style-preset-card__sample",s.textContent="Aa",e.preview.text&&(s.style.color=e.preview.text),i.appendChild(s);const r=document.createElement("h4");if(r.className="sidebar-jlg-style-preset-card__title",r.textContent=e.label,t.appendChild(i),t.appendChild(r),e.description){const i=document.createElement("p");i.className="sidebar-jlg-style-preset-card__description",i.textContent=e.description,t.appendChild(i)}const a=document.createElement("span");return a.className="sidebar-jlg-style-preset-card__cta",a.textContent=o,t.appendChild(a),t.addEventListener("click",()=>{_(e)}),t})(e);"custom"===e.key&&(m=t),n.appendChild(t),S[e.key]=e});const x=t.value&&""!==t.value?t.value:"custom";g(x),y();const k=i.querySelector("[data-style-preset-quick]");k&&k.querySelectorAll("[data-style-preset-trigger]").forEach(e=>{e.addEventListener("click",()=>{const t=(e.getAttribute("data-style-preset-trigger")||"").trim(),i=t&&S[t]?S[t]:S.custom;i&&_(i)})});const j=document.getElementById("tab-presets");if(j){const e=e=>{if(h)return;const n=e.target;n instanceof HTMLElement&&i.contains(n)&&("custom"!==t.value&&(b("custom"),g("custom")),window.requestAnimationFrame(()=>{y()}))};j.addEventListener("input",e),j.addEventListener("change",e)}}(function(e){const t=document.getElementById("sidebar-jlg-preview-compare"),i=document.getElementById("sidebar-jlg-form");if(!t||!e)return{exit:()=>Promise.resolve(),isActive:()=>!1};const n=t.querySelector(".sidebar-jlg-preview__toolbar-button-label"),r=s("stylePresetCompareButton",(n&&n.textContent?n.textContent.trim():(t.textContent||"").trim())||"Comparer avant/après"),a=s("stylePresetCompareExit","Revenir à l’après"),o=s("stylePresetCompareBefore",""),l=s("stylePresetCompareAfter","");n?n.textContent=r:t.textContent=r,t.setAttribute("aria-label",r),t.setAttribute("aria-pressed","false");const c={active:!1,disabledFields:[],afterOptions:null,busy:!1},d=e=>{const i=e?a:r;n?n.textContent=i:t.textContent=i,t.classList.toggle("is-active",e),t.setAttribute("aria-pressed",e?"true":"false"),t.setAttribute("aria-label",i)},u=e=>{c.busy=e,t.disabled=e,t.classList.toggle("is-busy",e)},p=e=>{i&&(e?(c.disabledFields=[],Array.from(i.querySelectorAll("input, select, textarea, button")).forEach(e=>{e!==t&&(e.disabled||(e.disabled=!0,c.disabledFields.push(e)))}),i.setAttribute("aria-disabled","true")):(c.disabledFields.forEach(e=>{e.disabled=!1}),c.disabledFields=[],i.removeAttribute("aria-disabled")))},h=()=>{if(!c.active||c.busy)return Promise.resolve();const t=j.cloneObject(c.afterOptions||e.currentOptions||{});return d(!1),p(!1),u(!0),c.active=!1,e.currentOptions=t,e.loadPreview().then(()=>{e.applyOptions(),l?e.setStatus(l,!1):e.clearStatus()}).catch(()=>{e.clearStatus()}).finally(()=>{c.afterOptions=null,u(!1)})};return t.addEventListener("click",t=>{t.preventDefault(),c.active?h():(()=>{if(c.active||c.busy)return Promise.resolve();c.afterOptions=j.cloneObject(e.currentOptions||{}),d(!0),p(!0),u(!0),c.active=!0,e.currentOptions=j.cloneObject(e.initialOptions||{}),e.loadPreview().then(()=>{e.applyOptions(),o&&e.setStatus(o,!1)}).catch(()=>{c.active=!1,p(!1),d(!1)}).finally(()=>{u(!1)})})()}),{exit:h,isActive:()=>c.active}}(U)),function(){const e=document.querySelector("[data-sidebar-section-nav]");e&&e.querySelectorAll("[data-sidebar-section-target]").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-sidebar-section-target");if(!t)return;const i=document.getElementById(t);if(!i)return;i.tagName&&"details"===i.tagName.toLowerCase()&&!i.open&&(i.open=!0);try{i.scrollIntoView({behavior:"smooth",block:"start"})}catch(e){i.scrollIntoView()}const n=i.querySelector("summary");if(n&&"function"==typeof n.focus)try{n.focus({preventScroll:!0})}catch(e){n.focus()}})})}(),"undefined"!=typeof window&&(window.SidebarJLGPreview=U);const R={getMode:()=>T.mode,setMode:(e,t={})=>q(e,t),getView:()=>T.view,setView:e=>B(e)};function H(e){p=Array.isArray(e)?e:[],Object.keys(L).forEach(e=>{delete L[e]}),Object.keys(F).forEach(e=>{delete F[e]}),p.forEach(e=>{if(!e||"string"!=typeof e.key)return;const t=e.key;if(L[t]=e,""===t)return;F[t]||(F[t]=t);const i=pe(t);i&&!F[i]&&(F[i]=t)})}function K(e,t=""){C&&console.log(`[Sidebar JLG Debug] ${e}`,t)}function W(e,i,n){const r=t("#sidebar-jlg-js-notices"),a=r.length?r:t(".sidebar-jlg-admin-wrap");if(!a||!a.length)return;const o={autoDismiss:!0,dismissDelay:8e3,maxVisible:3,actions:[],message:""};let l="string"==typeof i?i:"",c=t.extend(!0,{},o);i&&"object"==typeof i&&!Array.isArray(i)&&(c=t.extend(!0,c,i),"string"==typeof i.message&&(l=i.message)),n&&"object"==typeof n&&(c=t.extend(!0,c,n)),"string"==typeof c.message&&c.message&&(l=c.message),c.message=l;const d=i&&"object"==typeof i&&!Array.isArray(i)&&Object.prototype.hasOwnProperty.call(i,"autoDismiss")||n&&"object"==typeof n&&Object.prototype.hasOwnProperty.call(n,"autoDismiss"),u="string"==typeof e?e.toLowerCase():"info",p={success:"sidebar-jlg-toast--success",error:"sidebar-jlg-toast--error",warning:"sidebar-jlg-toast--warning",info:"sidebar-jlg-toast--info"},h={success:"✓",error:"!",warning:"!",info:"i"},m={success:s("noticeToneSuccess","Succès"),error:s("noticeToneError","Erreur"),warning:s("noticeToneWarning","Avertissement"),info:s("noticeToneInfo","Information")},g=p[u]||p.info,b=h[u]||h.info,f=m[u]||m.info,y=s("dismissNotice","Ignorer cette notification.");"error"!==u||d||(c.autoDismiss=!1);const v=`sidebar-jlg-toast-${Date.now()}-${Math.floor(1e3*Math.random())}`,_=t("<section/>",{class:`sidebar-jlg-toast ${g}`,id:v,role:"status","aria-live":"polite","data-sidebar-toast":"true","data-autodismiss":c.autoDismiss?"true":"false"}),w=t("<span/>",{class:"sidebar-jlg-toast__icon","aria-hidden":"true"}).text(b),S=t("<div/>",{class:"sidebar-jlg-toast__body"}),x=t("<p/>",{class:"sidebar-jlg-toast__message"});x.text(l||"");const k=t("<div/>",{class:"sidebar-jlg-toast__meta"}),j=t("<span/>",{class:"screen-reader-text sidebar-jlg-toast__tone"});j.text(f);const C=Array.isArray(c.actions)?c.actions:[];if(C.length){const e=t("<div/>",{class:"sidebar-jlg-toast__actions"});C.forEach(i=>{if(!i||"object"!=typeof i||"string"!=typeof i.label)return;const n="string"==typeof i.href&&i.href,s=n?"<a/>":"<button/>",r={class:"sidebar-jlg-toast__action"};n?(r.href=i.href,i.target&&(r.target=i.target),i.rel&&(r.rel=i.rel)):r.type="button";const o=t(s,r);o.text(i.label),n||"function"!=typeof i.onClick||o.on("click",e=>{e.preventDefault(),i.onClick.call(e.currentTarget,e,{id:v,remove:()=>F(_,a)})}),"string"==typeof i.description&&i.description&&o.attr("aria-label",`${i.label}. ${i.description}`),e.append(o)}),e.children().length&&k.append(e)}S.append(j).append(x),k.children().length&&S.append(k);const E=t("<button/>",{type:"button",class:"sidebar-jlg-toast__close","aria-label":y}),O=t("<span/>",{class:"screen-reader-text"});O.text(y),E.append(O);const A=t("<div/>",{class:"sidebar-jlg-toast__progress"}),L=t("<div/>",{class:"sidebar-jlg-toast__progress-bar"});A.append(L),_.append(w,S,E,A);const F=(e,t=a)=>{e&&e.length&&!e.hasClass("is-leaving")&&(e.addClass("is-leaving"),setTimeout(()=>{e.remove(),$(t)},220))},$=(e=a)=>{const t=e.find("[data-sidebar-toast]").length;e.is(".sidebar-jlg-aria-notices")&&(e.attr("data-sidebar-notices",String(t)),t<=0?e.attr("aria-hidden","true"):e.removeAttr("aria-hidden"))},z=Number.isFinite(c.maxVisible)&&c.maxVisible>0?Math.floor(c.maxVisible):o.maxVisible;a.prepend(_),$(a);const I=a.find("[data-sidebar-toast]");I.length>z&&I.slice(z).each(function(){F(t(this),a)});const T=()=>F(_,a);E.on("click",e=>{e.preventDefault(),T()});let P=Math.max(1500,parseInt(c.dismissDelay,10)||o.dismissDelay),N=null,M=null;const D=()=>{c.autoDismiss&&null===N&&(M=Date.now(),N=window.setTimeout(()=>{N=null,T()},P),L.length&&(L.css("animation-duration",`${P}ms`),L.css("animation-play-state","running")))},q=()=>{c.autoDismiss&&(_.is(":hover")||_.is(":focus-within")||(P<=0?T():D()))};c.autoDismiss?(L.css("animation-duration",`${P}ms`),L.css("animation-play-state","paused"),"undefined"!=typeof window&&"function"==typeof window.requestAnimationFrame?window.requestAnimationFrame(D):D(),_.on("mouseenter focusin",()=>{c.autoDismiss&&null!==N&&(clearTimeout(N),N=null,null!==M&&(P-=Date.now()-M),L.length&&L.css("animation-play-state","paused"))}),_.on("mouseleave focusout",()=>{setTimeout(q,10)})):L.css("animation","none")}function Q(e,t){if(e&&"object"==typeof e){if(e.data&&"string"==typeof e.data.message)return e.data.message;if("string"==typeof e.message)return e.message}return t}"undefined"!=typeof window&&(window.SidebarJLGExperience=R),e.exports&&(e.exports.SidebarJLGExperience=R),H(p),K("Admin script loaded.",a),t(".color-picker-rgba").wpColorPicker({change:function(e,i){t(e.target).val(i.color.toString()).trigger("change")},clear:function(){t(this).val("").trigger("change")}}),i.e(956).then(i.bind(i,18)).then(({initSearchSection:e})=>e(t,s)),V=i.e(54).then(i.bind(i,316)).then(({initProfilesSection:e})=>(G=e(t,U,W,s),G)),i.e(7).then(i.bind(i,11)).then(({initHeaderSection:e})=>e(t)),t(".desktop-behavior-select").on("change",function(){t(".push-option-field").toggle("push"===t(this).val())}).trigger("change");const X=t('input[name="sidebar_jlg_settings[layout_style]"]');function Y(){const e=X.filter(":checked").val();t(".floating-options-field").toggle("floating"===e),t(".horizontal-options-field").toggle("horizontal-bar"===e)}X.on("change",Y),Y();const Z=t('input[name="sidebar_jlg_settings[enable_search]"]'),ee=t(".search-options-wrapper"),te=t(".search-method-select");Z.on("change",function(){ee.toggle(t(this).is(":checked"))}).trigger("change"),te.on("change",function(){const e=t(this).val();ee.find(".search-method-field").hide(),ee.find(`.search-${e}-field`).show()}).trigger("change");const ie=t("#icon-library-modal");let ne=null;const se=t("<input>",{type:"file",accept:".svg,image/svg+xml",style:"display:none;","aria-hidden":"true"});t("body").append(se),se.on("change",function(){const e=se.data("originButton"),t=this.files,i=t&&t.length?t[0]:null;se.val(""),se.removeData("originButton"),e&&e.length&&(i?de(e,i,i.name):oe(e,"",!1))});let re=null;function ae(e,t){if(!e||!e.length)return;const i=!!t;e.prop("disabled",i),i?(e.addClass("is-busy"),e.attr("aria-busy","true")):(e.removeClass("is-busy"),e.removeAttr("aria-busy"))}function oe(e,i,n=!1){const s=function(e){if(!e||!e.length)return t();const i=e.closest(".sidebar-jlg-custom-icon-upload");return i.length?i.find(".sidebar-jlg-upload-feedback"):t()}(e);if(!s.length)return void(i&&K("SVG upload message",i));const r=i||"";s.text(r),s.toggleClass("is-error",!!n)}function le(e){e&&window.wp&&wp.a11y&&"function"==typeof wp.a11y.speak&&wp.a11y.speak(e)}function ce(e,t){const i=t||s("iconUploadErrorGeneric","Le téléversement du SVG a échoué.");oe(e,i,!0),le(i)}function de(e,i,n){if(!i)return ce(e,s("iconUploadErrorGeneric","Le téléversement du SVG a échoué.")),!1;if(!h||!l)return ce(e,s("iconUploadErrorGeneric","Le téléversement du SVG a échoué.")),!1;const r="string"==typeof n&&""!==n.trim()?n.trim():"icon.svg";if(!function(e,t){return"image/svg+xml"===("string"==typeof t?t.toLowerCase():"")||"string"==typeof e&&/\.svg(?:\?.*)?$/i.test(e.trim())}(r,i.type))return ce(e,s("iconUploadErrorMime","Seuls les fichiers SVG sont acceptés.")),!1;if(g>0&&i.size>g){const t=s("iconUploadErrorSize","Le fichier dépasse la taille maximale autorisée de %d Ko.").replace("%d",Math.ceil(g/1024));return ce(e,t),!1}const a=new FormData;a.append("action",h),a.append("nonce",c),a.append("icon_file",i,r),ae(e,!0),oe(e,s("iconUploadInProgress","Téléversement du SVG en cours…"),!1);const o=t.ajax({url:l,method:"POST",data:a,processData:!1,contentType:!1});return o.done(t=>{if(!t||"object"!=typeof t)return void ce(e,s("iconUploadErrorGeneric","Le téléversement du SVG a échoué."));if(!t.success){const i=t.data&&"string"==typeof t.data?t.data:s("iconUploadErrorGeneric","Le téléversement du SVG a échoué.");return void ce(e,i)}const i=t.data||{};Array.isArray(i.icon_manifest)&&(sidebarJLG.icons_manifest=i.icon_manifest,H(sidebarJLG.icons_manifest),ie.is(":visible")&&fe()),"string"==typeof i.icon_key&&"string"==typeof i.icon_markup&&(O[i.icon_key]=i.icon_markup);const n="string"==typeof i.message&&""!==i.message?i.message:s("iconUploadSuccess","Icône SVG ajoutée.");oe(e,n,!1),le(n),K("Custom SVG uploaded.",i)}),o.fail(t=>{const i=function(e){if(e&&e.responseJSON){const t=e.responseJSON;if(t.data&&"string"==typeof t.data)return t.data;if(t.message&&"string"==typeof t.message)return t.message}return e&&"string"==typeof e.responseText&&""!==e.responseText?e.responseText:s("iconUploadErrorGeneric","Le téléversement du SVG a échoué.")}(t);ce(e,i)}),o.always(()=>{ae(e,!1)}),o}function ue(e){se.data("originButton",e),se.trigger("click")}function pe(e){return"string"!=typeof e?"":e.toLowerCase().replace(/[^a-z0-9_\-]/g,"")}function he(e){if("string"!=typeof e)return"";const t=e.trim();return""===t?"":F[t]||F[pe(t)]||""}function me(e){const t=he(e);return t&&L[t]||null}function ge(e=[]){const i=Array.from(new Set(e.map(he).filter(e=>e&&!O[e])));if(0===i.length||!l||!d)return Promise.resolve(O);const n=i.slice().sort().join(",");if(A[n])return A[n];const s={action:d,nonce:c,icons:i},r=t.post(l,s).then(e=>{if(!e||!e.success||"object"!=typeof e.data)throw new Error("Invalid icon response");return Object.keys(e.data).forEach(t=>{const i=e.data[t];"string"==typeof i&&(O[t]=i)}),e.data}).catch(e=>(K("Icon fetch failed.",{keys:i,error:e}),{})).finally(()=>{delete A[n]});return A[n]=r,r}let be=0;function fe(){const e=t("#icon-grid");e.empty();const i=[];p.forEach(n=>{if(!n||"string"!=typeof n.key||""===n.key)return;const s=n.key,r="string"==typeof n.label&&""!==n.label.trim()?n.label:s,a=t("<button>",{type:"button",title:s});a.attr("data-icon-name",s),a.attr("data-icon-search",(s+" "+r).toLowerCase());const o=t("<span>",{class:"icon-preview","aria-hidden":"true"}),l=t("<span>",{class:"icon-label"}).text(r);a.append(o),a.append(l),e.append(a),O[s]?o.html(O[s]):i.push(s)}),i.length>0&&ge(i).then(()=>{e.find("button").each(function(){const e=t(this).attr("data-icon-name"),i=O[e];i&&t(this).find(".icon-preview").html(i)})})}function ye(e,i){const n=t(e).val();if(!n)return void i.empty();if("svg_url"===t(e).closest(".menu-item-box").find(".menu-item-icon-type").val())return void _(n,i);const s=me(n);if(!s)return void i.empty();const r=s.key,a=++be;i.data("iconRequestId",a),O[r]?i.html(O[r]):ge([r]).then(()=>{if(i.data("iconRequestId")!==a)return;const e=O[r];e?i.html(e):i.empty()})}function ve(e){const i=t(`#${e.containerId}`),n=wp.template(e.templateId),s=a[e.dataKey]||[];function r(t){if(!t||!t.length)return;let i=t.data("fallbackTitle");i="string"!=typeof i?"":i.trim(),""===i&&(i=(e.newTitle||"").trim(),t.data("fallbackTitle",i));const n=t.find(".item-label");let s="";if(n.length){const e=n.val();"string"==typeof e?s=e.trim():Array.isArray(e)&&(s=e.join(" ").trim())}t.find(".item-title").text(s||i)}function o(){K(`Réindexation de ${e.dataKey}`),i.children(".menu-item-box").each(function(i){t(this).find("input, select, textarea").each(function(){const n=t(this),s=n.attr("name");if(s){let t=s;"menu_items"===e.dataKey?t=s.replace(/\[menu_items\]\[\d+\]/g,`[menu_items][${i}]`):"social_icons"===e.dataKey&&(t=s.replace(/\[social_icons\]\[\d+\]/g,`[social_icons][${i}]`)),s!==t&&(n.attr("name",t),K(`Champ réindexé : ${s} -> ${t}`))}})}),K(`Réindexation terminée : ${i.children(".menu-item-box").length} éléments`)}i.sortable({handle:".menu-item-handle",placeholder:"menu-item-placeholder",update:function(e,t){K("Ordre modifié par drag & drop"),o()}}),s.forEach((s,a)=>{s.index=a;const o=t(n(s));i.append(o),e.onAppend&&e.onAppend(o,s),r(o)}),t(`#${e.addButtonId}`).on("click",function(){const s=i.children(".menu-item-box").length,a=e.newItem(s);a.index=s;const l=t(n(a));i.append(l),e.onAppend&&e.onAppend(l,a),r(l),setTimeout(function(){o(),K(`Nouvel élément ajouté à ${e.dataKey}`)},100)}),i.on("click",`.${e.deleteButtonClass}`,function(){const i=t(this).closest(".menu-item-box"),n=i.find(".item-label").val()||i.find(".item-title").text();confirm(`Supprimer "${n}" ?`)&&i.fadeOut(200,function(){t(this).remove(),o(),K(`Élément supprimé de ${e.dataKey}`)})}),i.on("input",".item-label",function(){r(t(this).closest(".menu-item-box"))}),i.on("change",".icon-input",function(){ye(this,t(this).siblings(".icon-preview"))}),i.on("change",".menu-item-icon-type",function(){_e(t(this).closest(".menu-item-box"))}),o()}function _e(e){const i=e.find(".menu-item-type").val(),n=e.find(".menu-item-icon-type"),a=n.val(),l=e.find(".menu-item-icon-wrapper"),c=e.index(),d="menu-items-container"===e.parent().attr("id")?"menu_items":"social_icons",u=l.find(".icon-input"),p=u.length?u.val():"",h="string"==typeof p?p:"";if(l.empty(),"separator"===i){n.prop("disabled",!0),n.val("svg_inline");const e=s("menuSeparatorIconDisabled","Les séparateurs n’affichent pas d’icône.");return void l.append(t("<p>",{class:"description menu-item-icon-disabled"}).text(e))}if(n.prop("disabled",!1),"svg_url"===a){l.html(`\n                <input type="text" class="widefat icon-input"\n                       name="sidebar_jlg_settings[${d}][${c}][icon]"\n                       placeholder="https://example.com/icon.svg">\n                <button type="button" class="button choose-svg">Choisir depuis la médiathèque</button>\n                <span class="icon-preview"></span>\n                <span class="icon-preview-status" role="status" aria-live="polite"></span>\n                <p class="description icon-url-hint"></p>\n            `);const e=o(r()),t=l.find(".icon-url-hint");t.length&&(e?t.text(`Les SVG personnalisés doivent provenir de : ${e}`):t.text("Les SVG personnalisés doivent provenir du dossier de téléversement autorisé."))}else l.html(`\n                <input type="text" class="widefat icon-input"\n                       name="sidebar_jlg_settings[${d}][${c}][icon]"\n                       placeholder="Nom de l'icône">\n                <button type="button" class="button choose-icon">Parcourir les icônes</button>\n                <span class="icon-preview"></span>\n            `);const m=l.find(".icon-input");m.length&&(""!==h?m.val(h).trigger("change"):"svg_url"===a?_("",l.find(".icon-preview")):(m.removeClass("icon-input-invalid"),m.removeAttr("aria-invalid")))}function we(e){return"jlg_get_posts"===e?E.posts:E.categories}function Se(e,i){const n=e.find(".menu-item-type").val(),r=e.find(".menu-item-value-wrapper"),a=e.index(),o=i.value||"",l=e.find(".item-label"),c=s("menuItemDefaultTitle","Nouvel élément"),d=t=>{const i="string"==typeof t&&""!==t.trim()?t.trim():c;e.data("fallbackTitle",i);const n=l.length&&"string"==typeof l.val()?l.val().trim():"";e.find(".item-title").text(n||i)};let u=r.find(".menu-item-field-container");if(!u.length){u=t("<div>",{class:"menu-item-field-container"});const e=r.children().not(".menu-item-search-container");e.length&&u.append(e),r.prepend(u)}let p=r.find(".menu-item-search-container");if(!p.length){p=t("<div>",{class:"menu-item-search-container"});const e=t("<input>",{type:"search",class:"menu-item-search-input",placeholder:"Rechercher…","aria-label":"Rechercher un élément"}),i=t("<div>",{class:"menu-item-search-status","aria-live":"polite"});p.append(e,i).css("display","none"),r.append(p)}const h=p.find(".menu-item-search-input"),m=p.find(".menu-item-search-status");if(h.off(".sidebarSearch"),u.empty(),"separator"===n){const e=s("menuSeparatorDescription","Ce séparateur structure le menu sans lien cliquable."),i=s("menuSeparatorPlaceholder","Titre de section (optionnel)"),n=s("menuSeparatorDefaultTitle","Séparateur"),r=t("<input>",{type:"hidden",name:`sidebar_jlg_settings[menu_items][${a}][value]`,value:""}),o=t("<p>",{class:"description menu-item-separator-description"}).text(e);return u.append(r,o),l.length&&l.attr("placeholder",i),d(n),v(r[0]),h.val(""),m.empty(),void p.css("display","none")}if(l.length&&l.removeAttr("placeholder"),"custom"===n)u.html(`\n                <p><label>URL</label>\n                <input type="text" class="widefat"\n                       name="sidebar_jlg_settings[menu_items][${a}][value]"\n                       value="${o}" placeholder="https://..."></p>\n            `),h.val(""),m.empty(),p.css("display","none"),d(c);else if("cta"===n){const e=s("ctaTitleLabel","Titre du bloc"),n=s("ctaDescriptionLabel","Description"),r=s("ctaButtonLabel","Texte du bouton"),l=s("ctaButtonUrlLabel","Lien du bouton"),g=s("ctaShortcodeLabel","Shortcode (optionnel)"),b=s("ctaButtonUrlPlaceholder","https://..."),f="string"==typeof i.cta_title?i.cta_title:"",y="string"==typeof i.cta_description?i.cta_description:"",_="string"==typeof i.cta_button_label?i.cta_button_label:"",w="string"==typeof i.cta_button_url&&""!==i.cta_button_url.trim()?i.cta_button_url:o,S="string"==typeof i.cta_shortcode?i.cta_shortcode:"",x=t("<div>",{class:"menu-item-cta-fields","data-menu-item-cta-fields":"1"}),k=t("<p>");k.append(t("<label>").text(e));const j=t("<input>",{type:"text",class:"widefat menu-item-cta-title",name:`sidebar_jlg_settings[menu_items][${a}][cta_title]`}).val(f);k.append(j);const C=t("<p>");C.append(t("<label>").text(n));const E=t("<textarea>",{class:"widefat menu-item-cta-description",rows:3,name:`sidebar_jlg_settings[menu_items][${a}][cta_description]`}).val(y);C.append(E);const O=t("<p>");O.append(t("<label>").text(r));const A=t("<input>",{type:"text",class:"widefat menu-item-cta-button-label",name:`sidebar_jlg_settings[menu_items][${a}][cta_button_label]`}).val(_);O.append(A);const L=t("<p>");L.append(t("<label>").text(l));const F=t("<input>",{type:"url",class:"widefat menu-item-cta-button-url",placeholder:b,name:`sidebar_jlg_settings[menu_items][${a}][cta_button_url]`}).val(w||"");L.append(F);const $=t("<input>",{type:"hidden",name:`sidebar_jlg_settings[menu_items][${a}][value]`}).val(w||"");L.append($);const z=t("<p>");z.append(t("<label>").text(g));const I=t("<textarea>",{class:"widefat menu-item-cta-shortcode",rows:2,name:`sidebar_jlg_settings[menu_items][${a}][cta_shortcode]`}).val(S);z.append(I),x.append(k).append(C).append(O).append(L).append(z),u.append(x);const T=e=>{const t="string"==typeof e?e.trim():"";d(t||c)};T(f),j.on("input",function(){T(this.value||"")}),F.on("input",function(){const e="string"==typeof this.value?this.value.trim():"";$.val(e),v($[0])}),h.val(""),m.empty(),p.css("display","none")}else if("post"===n||"page"===n||"category"===n){const e="post"===n||"page"===n?"jlg_get_posts":"jlg_get_categories",s=`sidebar_jlg_settings[menu_items][${a}][value]`,r={post:"Article",page:"Page",category:"Catégorie"}[n]||"Élément",l=t("<label>").text(r),g=t("<select>",{class:"widefat",name:s}),b=null!=o?String(o):"",f=i.current_label||i.value_label||i.label||"",y=()=>{if(!b)return null;const e=document.createElement("option");return e.value=b,e.textContent=f||`Élément actuel (ID: ${b})`,e.selected=!0,e.dataset.currentOption="1",e},v=y();v&&g.append(v);const _=document.createElement("option");_.value="",_.textContent="Chargement...",_.disabled=!0,_.dataset.loadingOption="1",v||(_.selected=!0),g.append(_);const w=t("<p>");w.append(l),w.append(g),u.append(w),p.css("display","flex"),m.empty(),d(c);const S=20,x=(t,i)=>{const s=(t||"").trim(),r={action:e,nonce:sidebarJLG.nonce,page:i,posts_per_page:S,search:s};return b&&(r.include=b),"page"!==n&&"post"!==n||(r.post_type=n),r},k=(i,s=1)=>{const r=x(i,s);m.text("Chargement..."),g.prop("disabled",!0),g.data("current-search",r.search),h.data("current-page",s);const a=g.children().not('[data-loading-option="1"]').map(function(){return t(this).clone()}).get(),o=g.val();(function(e,i){const n=we(e);i.search="string"==typeof i.search?i.search:"";const s=function(e,t,i,n,s,r){return[e,null!=t&&""!==t?Array.isArray(t)?t.join(","):String(t):"",i,n,s?String(s):"","string"==typeof r?r:""].join("|")}(e,i.include,i.page,i.posts_per_page,i.post_type,i.search);if(n[s])return n[s];const r=t.post(sidebarJLG.ajax_url,i);return r.fail(function(){delete n[s]}),n[s]=r,r})(e,r).done(function(t){!function(e,t,i,n,s,r,a,o=[],l=""){if(e.closest("body").length){if(a&&a.empty(),i.success){const r="id",o="category"===t?"name":"title",l=Array.isArray(i.data)?i.data:[],c=n&&l.some(e=>String(e[r])===n);if(e.empty(),!c){const t=s();t&&e.append(t)}if(l.forEach(t=>{const i=document.createElement("option");i.value=t[r],i.textContent=t[o]||"",n&&String(t[r])===n&&(i.selected=!0),e.append(i)}),a&&0===l.length&&a.text("Aucun résultat"),!e.children().length){const t=document.createElement("option");t.value="",t.textContent="Aucun résultat",e.append(t)}}else{K(`Failed to fetch data for ${r}.`);const t=Array.isArray(o)&&o.length>0;if(e.empty(),t)o.forEach(t=>{t&&t.length&&e.append(t)}),null!=l&&""!==l&&e.val(l);else{const t=s();t&&e.append(t);const i=document.createElement("option");i.value="",i.textContent="Erreur de chargement",i.disabled=!0,e.append(i)}a&&a.text("Erreur de chargement. Vérifiez votre connexion puis réessayez.")}e.prop("disabled",!1)}}(g,n,t,b,y,e,m,a,o)}).fail(function(){!function(e,t,i,n,s=[],r=""){if(K(`AJAX request failed for ${i}.`),!e.closest("body").length)return;const a=Array.isArray(s)&&s.length>0;if(e.empty(),a)s.forEach(t=>{t&&t.length&&e.append(t)}),null!=r&&""!==r&&e.val(r);else{const i=t();i&&e.append(i);const n=document.createElement("option");n.value="",n.textContent="Erreur de chargement",n.disabled=!0,e.append(n)}n&&n.text("Erreur de chargement. Vérifiez votre connexion puis réessayez."),e.prop("disabled",!1)}(g,y,e,m,a,o)}).always(function(){"Chargement..."===m.text()&&m.empty()})},j=()=>{const t=(h.val()||"").trim();t!==(h.data("last-search")||"")&&(h.data("last-search",t),function(e){const t=we(e);Object.keys(t).forEach(e=>delete t[e])}(e),k(t,1))},C=(h.val()||"").trim();h.data("last-search",C),k(C,1);const E=function(e){let t;return function(...i){const n=this;clearTimeout(t),t=setTimeout(()=>e.apply(n,i),300)}}(j);h.on("input.sidebarSearch search.sidebarSearch",E)}else if("nav_menu"===n){const t=s("navMenuFieldLabel","Menu WordPress"),n=s("navMenuSelectPlaceholder","Sélectionnez un menu…"),r=s("navMenuDepthLabel","Profondeur maximale"),l=s("navMenuDepthHelp","0 = illimité"),g=s("navMenuFilterLabel","Filtrage"),b=s("navMenuFilterAll","Tous les éléments"),f=s("navMenuFilterTopLevel","Uniquement le niveau 1"),y=s("navMenuFilterBranch","Branche de la page courante"),v=["all","top-level","current-branch"],_=null!=o?String(o):"";let j=parseInt(i.nav_menu_max_depth,10);(!Number.isFinite(j)||j<0)&&(j=0);let C="string"==typeof i.nav_menu_filter?i.nav_menu_filter:"";v.includes(C)||(C="all"),u.html(`\n                <p>\n                    <label>${t}</label>\n                    <select class="widefat menu-item-nav-select" name="sidebar_jlg_settings[menu_items][${a}][value]">\n                        <option value="">${n}</option>\n                    </select>\n                </p>\n                <p>\n                    <label>${r}</label>\n                    <input type="number" class="small-text menu-item-nav-depth" min="0" step="1"\n                        name="sidebar_jlg_settings[menu_items][${a}][nav_menu_max_depth]"\n                        value="${j}">\n                    <span class="description">${l}</span>\n                </p>\n                <p>\n                    <label>${g}</label>\n                    <select class="widefat menu-item-nav-filter" name="sidebar_jlg_settings[menu_items][${a}][nav_menu_filter]">\n                        <option value="all"${"all"===C?" selected":""}>${b}</option>\n                        <option value="top-level"${"top-level"===C?" selected":""}>${f}</option>\n                        <option value="current-branch"${"current-branch"===C?" selected":""}>${y}</option>\n                    </select>\n                </p>\n            `),h.val(""),m.empty(),p.css("display","none"),d(c);const E=u.find(".menu-item-nav-select"),O=u.find(".menu-item-nav-depth"),A=t=>{const i=t||s("menuItemDefaultTitle","Nouvel élément");e.data("fallbackTitle",i);const n=e.find(".item-label"),r=n.length&&"string"==typeof n.val()?n.val().trim():"";e.find(".item-title").text(r||i)};A(""),function(){if(Array.isArray(w))return Promise.resolve(w);if(S)return S;const e=function(){if(!window.wp||!wp.data||"function"!=typeof wp.data.select)return null;const e=wp.data.select("core");if(!e||"function"!=typeof e.getMenus)return null;const t=e.getMenus();if(Array.isArray(t))return Promise.resolve(x(t));if(!wp.data.dispatch||"function"!=typeof wp.data.dispatch)return null;const i=wp.data.dispatch("core");return i&&"function"==typeof i.fetchMenus?new Promise(t=>{const n=wp.data.subscribe(()=>{const i=e.getMenus();Array.isArray(i)&&(n(),t(x(i)))});try{i.fetchMenus()}catch(e){n(),t([])}}):null}();return e?(S=e.then(e=>(w=e,e)).catch(()=>k().then(e=>(w=e,e))),S):(S=k().then(e=>(w=e,e)),S)}().then(e=>{const t=Array.isArray(e)?e:[];E.empty();const i=document.createElement("option");i.value="",i.textContent=n,E.append(i);let s="";t.forEach(e=>{if(!e||void 0===e.id)return;const t=document.createElement("option");t.value=String(e.id),t.textContent=e.name||e.slug||t.value,""!==_&&t.value===_&&(t.selected=!0,s=t.textContent),E.append(t)}),A(s)}).catch(()=>{A("")}),E.on("change",function(){const e=this.options[this.selectedIndex],t=e&&e.value?e.textContent:"";A(t)}),O.on("input",function(){const e=parseInt(this.value,10);(!Number.isFinite(e)||e<0)&&(this.value="0")})}else u.empty(),h.val(""),m.empty(),p.css("display","none"),d(c)}t("body").on("click",".choose-icon",function(){var e;e=t(this).siblings(".icon-input"),t(this).siblings(".icon-preview"),ne=e,fe(),ie.show()}),t("body").on("click",".choose-svg",function(){!function(e){const t=wp.media({title:"Sélectionner une icône SVG",button:{text:"Utiliser cette icône"},library:{type:"image/svg+xml"},multiple:!1});t.on("select",function(){const i=t.state().get("selection").first().toJSON();e.val(i.url).trigger("change")}),t.open()}(t(this).siblings(".icon-input"),t(this).siblings(".icon-preview"))}),t(".sidebar-jlg-upload-svg").on("click",function(e){var i;e.preventDefault(),(i=t(this))&&i.length&&(h&&l?function(e){window.wp&&wp.media&&"function"==typeof wp.media?(re||(re=wp.media({title:s("iconUploadMediaTitle","Sélectionner un fichier SVG"),button:{text:s("iconUploadMediaButton","Utiliser ce SVG")},library:{type:"image/svg+xml"},multiple:!1})),re.off("select"),re.on("select",function(){const t=re.state().get("selection"),i=t?t.first():null;if(!i||"function"!=typeof i.toJSON)return void ce(e,s("iconUploadErrorGeneric","Le téléversement du SVG a échoué."));const n=i.toJSON();n&&n.url?"function"==typeof window.fetch?(oe(e,s("iconUploadPreparing","Préparation du fichier…"),!1),ae(e,!0),fetch(n.url,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw new Error("network_error");return e.blob()}).then(t=>{ae(e,!1),de(e,t,n.filename||"icon.svg")}).catch(()=>{ae(e,!1),ce(e,s("iconUploadErrorFetch","Impossible de récupérer le fichier depuis la médiathèque."))})):ue(e):ce(e,s("iconUploadErrorGeneric","Le téléversement du SVG a échoué."))}),re.open()):ue(e)}(i):ce(i,s("iconUploadErrorGeneric","Le téléversement du SVG a échoué.")))}),ie.on("click",".modal-close, .modal-backdrop",()=>ie.hide()),t("#icon-grid").on("click","button",function(){const e=t(this).attr("data-icon-name");ne.val(e).trigger("change"),ie.hide()}),t("#icon-search").on("input",function(){const e=t(this).val().toLowerCase();t("#icon-grid button").each(function(){const i=(t(this).attr("data-icon-search")||"").toLowerCase();t(this).toggle(i.includes(e))})}),ve({containerId:"menu-items-container",templateId:"menu-item",dataKey:"menu_items",addButtonId:"add-menu-item",deleteButtonClass:"delete-menu-item",newTitle:s("menuItemDefaultTitle","Nouvel élément"),newItem:e=>({index:e,label:"",type:"custom",value:"",icon_type:"svg_inline",icon:"",nav_menu_max_depth:0,nav_menu_filter:"all",cta_title:"",cta_description:"",cta_button_label:"",cta_button_url:"",cta_shortcode:""}),onAppend:(e,t)=>{Se(e,t),_e(e),e.find(".icon-input").val(t.icon).trigger("change")}}),t("#menu-items-container").on("change",".menu-item-type",function(){const e=t(this).closest(".menu-item-box");Se(e,"nav_menu"===t(this).val()?{value:"",nav_menu_max_depth:0,nav_menu_filter:"all"}:{value:""}),_e(e)});const xe=["facebook_white","facebook_black","x_white","x_black","instagram_white","instagram_black","youtube_white","youtube_black","linkedin_white","linkedin_black","github_white","github_black","tiktok_white","tiktok_black","pinterest_white","pinterest_black","whatsapp_white","whatsapp_black","telegram_white","telegram_black"];ge(xe);let ke=0;function je(e,t){if(!e||"function"!=typeof e.html)return;const i=me(t);if(!i)return void e.empty();const n=i.key,s=++ke;e.data("socialIconRequestId",s),O[n]?e.html(O[n]):ge([n]).then(()=>{if(e.data("socialIconRequestId")!==s)return;const t=O[n];t?e.html(t):e.empty()})}ve({containerId:"social-icons-container",templateId:"social-icon",dataKey:"social_icons",addButtonId:"add-social-icon",deleteButtonClass:"delete-social-icon",newTitle:s("socialIconDefaultTitle","Nouvelle icône"),newItem:e=>({index:e,label:"",url:"",icon:"facebook_white"}),onAppend:(e,i)=>{const n=e.find(".social-icon-select");!function(e,i){e.empty(),xe.forEach(n=>{const s=me(n);if(s){const r=s.label||n,a=r.charAt(0).toUpperCase()+r.slice(1);e.append(t("<option>",{value:s.key,text:a,selected:s.key===i}))}}),p.forEach(n=>{if(!n||!n.is_custom||"string"!=typeof n.key)return;const s=n.label||n.key.replace("custom_","").replace(/_/g," "),r=s.charAt(0).toUpperCase()+s.slice(1);e.append(t("<option>",{value:n.key,text:"Personnalisé: "+r,selected:n.key===i}))})}(n,i.icon);const r=e.find(".icon-preview");je(r,i.icon);const a=s("socialIconDefaultTitle","Nouvelle icône"),o="string"==typeof i.icon?i.icon:"",l=o?o.split("_")[0]:a;e.data("fallbackTitle",(l||a).trim()),n.on("change",function(){const i=t(this).val();je(r,i);const n=(("string"==typeof i&&""!==i?i.split("_")[0]:a)||a).trim();e.data("fallbackTitle",n);const s=e.find(".item-label"),o=s.length&&"string"==typeof s.val()?s.val().trim():"";e.find(".item-title").text(o||n)})}}),t("#sidebar-jlg-form").on("submit",function(e){K("Soumission du formulaire..."),K(`Éléments à sauvegarder : ${t("#menu-items-container .menu-item-box").length} menus, ${t("#social-icons-container .menu-item-box").length} réseaux sociaux`);let i=!1;if(t("#menu-items-container input, #menu-items-container select").each(function(){const e=t(this).attr("name");e&&!e.match(/\[menu_items\]\[\d+\]/)&&(console.error("Erreur d'indexation détectée:",e),i=!0)}),i&&!confirm("Des erreurs d'indexation ont été détectées. Voulez-vous continuer ?"))return e.preventDefault(),!1}),t("#reset-jlg-settings").on("click",function(){if(!confirm("Êtes-vous sûr de vouloir réinitialiser tous les réglages ? Cette action est irréversible."))return;K("Reset button clicked.");const e=t(this);e.prop("disabled",!0).text("Réinitialisation..."),t.post(sidebarJLG.ajax_url,{action:"jlg_reset_settings",nonce:sidebarJLG.reset_nonce}).done(function(t){t.success?(K("Settings reset successfully. Reloading page."),alert("Les réglages ont été réinitialisés. La page va maintenant se recharger."),location.reload()):(K("Failed to reset settings.",t),alert("Erreur lors de la réinitialisation."),e.prop("disabled",!1).text("Réinitialiser tous les réglages"))}).fail(function(){K("AJAX request failed."),alert("La requête de réinitialisation a échoué."),e.prop("disabled",!1).text("Réinitialiser tous les réglages")})});const Ce=t("#export-jlg-settings"),Ee=t("#import-jlg-settings"),Oe=t("#import-jlg-settings-file");if(Ce.length){const e=Ce.text();Ce.on("click",function(){if(!l)return void W("error",s("exportError","Impossible de générer l’export."));if(!u)return void W("error",s("exportError","Impossible de générer l’export."));const i=s("exportConfirm","Voulez-vous exporter les réglages actuels ?");if(i&&!confirm(i))return;const n=s("exportInProgress","Export en cours…");Ce.prop("disabled",!0).text(n),t.post(l,{action:"jlg_export_settings",nonce:u}).done(function(e){if(e&&e.success&&e.data){const t=e.data,i=t.payload||{};let n="";try{n=JSON.stringify(i,null,2)}catch(e){K("Failed to stringify export payload.",e)}if(n){if("undefined"==typeof URL||"function"!=typeof URL.createObjectURL)return void W("error",s("exportError","Impossible de générer l’export."));const i=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(i),a=document.createElement("a");return a.href=r,a.download="string"==typeof t.file_name&&""!==t.file_name?t.file_name:"sidebar-jlg-settings.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r),void W("success",Q(e,s("exportSuccess","Export terminé. Le téléchargement va démarrer.")))}}W("error",Q(e,s("exportError","Impossible de générer l’export.")))}).fail(function(e){W("error",Q(e?e.responseJSON:null,s("exportError","Impossible de générer l’export.")))}).always(function(){Ce.prop("disabled",!1).text(e)})})}if(Ee.length&&Oe.length){const e=Ee.text();Ee.on("click",function(){if(!l)return void W("error",s("importError","L’import des réglages a échoué."));if(!u)return void W("error",s("importError","L’import des réglages a échoué."));const i=Oe.get(0);if(!i||!i.files||!i.files.length)return void W("error",s("importMissingFile","Veuillez sélectionner un fichier JSON avant de lancer l’import."));const n=s("importConfirm","Importer ces réglages écrasera la configuration actuelle. Continuer ?");if(n&&!confirm(n))return;const r=i.files[0];if("undefined"==typeof FormData)return void W("error",s("importError","L’import des réglages a échoué."));const a=new FormData;a.append("action","jlg_import_settings"),a.append("nonce",u),a.append("settings_file",r),Ee.prop("disabled",!0).text(s("importInProgress","Import en cours…")),Oe.prop("disabled",!0),t.ajax({url:l,method:"POST",data:a,processData:!1,contentType:!1}).done(function(e){if(e&&e.success)return W("success",Q(e,s("importSuccess","Réglages importés avec succès. Rechargement de la page…"))),void setTimeout(function(){location.reload()},1200);W("error",Q(e,s("importError","L’import des réglages a échoué.")))}).fail(function(e){W("error",Q(e?e.responseJSON:null,s("importError","L’import des réglages a échoué.")))}).always(function(){Ee.prop("disabled",!1).text(e),Oe.prop("disabled",!1).val("")})})}if("undefined"!=typeof window&&(window.SidebarJLGAdmin=window.SidebarJLGAdmin||{},window.SidebarJLGAdmin.updateIconPreview=ye,window.SidebarJLGAdmin.renderSvgUrlPreview=_),e.exports&&(e.exports.updateIconPreview=ye),C){const e=t('<button type="button" class="button" style="margin-left: 20px;">🐛 Debug Info</button>');e.on("click",function(e){e.preventDefault(),console.group("📊 Debug Sidebar JLG"),console.log("Menu items:",t("#menu-items-container .menu-item-box").length),console.log("Social icons:",t("#social-icons-container .menu-item-box").length),t("#menu-items-container .menu-item-box").each(function(e){console.log(`Menu ${e}:`,{label:t(this).find(".item-label").val(),type:t(this).find(".menu-item-type").val(),icon:t(this).find(".icon-input").val()})}),t("#social-icons-container .menu-item-box").each(function(e){console.log(`Social ${e}:`,{label:t(this).find(".item-label").val(),url:t(this).find(".social-url").val(),icon:t(this).find(".social-icon-select").val()})}),console.groupEnd()}),t(".nav-tab-wrapper").append(e)}K("Script initialization complete")})}},n={};function s(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={exports:{}};return i[e](r,r.exports,s),r.exports}s.m=i,s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce((t,i)=>(s.f[i](e,t),t),[])),s.u=e=>({7:"sidebar-admin-header",54:"sidebar-admin-profiles",956:"sidebar-admin-search"}[e]+".js"),s.miniCssF=e=>{},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="wp-sidebar:",s.l=(i,n,r,a)=>{if(e[i])e[i].push(n);else{var o,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==t+r){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",t+r),o.src=i),e[i]=[n];var p=(t,n)=>{o.onerror=o.onload=null,clearTimeout(h);var s=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach(e=>e(n)),t)return t(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),l&&document.head.appendChild(o)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=i[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={661:0};s.f.j=(t,i)=>{var n=s.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var r=new Promise((i,s)=>n=e[t]=[i,s]);i.push(n[2]=r);var a=s.p+s.u(t),o=new Error;s.l(a,i=>{if(s.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",o.name="ChunkLoadError",o.type=r,o.request=a,n[1](o)}},"chunk-"+t,t)}};var t=(t,i)=>{var n,r,[a,o,l]=i,c=0;if(a.some(t=>0!==e[t])){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);l&&l(s)}for(t&&t(i);c<a.length;c++)r=a[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0},i=globalThis.webpackChunkwp_sidebar=globalThis.webpackChunkwp_sidebar||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),s(711)})();